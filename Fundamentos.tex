\chapter{Fundamentos de lattice Boltzmann}

En este cap\'itulo se describir\'an los fundamentos necesarios y la sarasa obligatoria para m\'as o menos entender el detalle de un modelo de lattice Boltzmann.
Poner ac\'a la idea de mostrar este camino para llegar a lo que nos interesa de LB. Se puede comenzar mencionando el origen como aut\'omatas celulares, y el posterior descubrimiento como forma discreta de la ecuaci\'on de Boltzmann. En definitiva, \'esta \'ultima es la que abre el camino a usarlo como m\'etodo de resoluci\'on de PDE's. Ver r\'apido en Huang, Sukop, Lu.

\section{Naturaleza cin\'etica del m\'etodo}
\label{sec:kinetic}
La descripci\'on matem\'atica de la din\'amica de fluidos se basa en la hip\'otesis de un medio continuo, con escalas temporales y espaciales suficientemente mayores que las asociadas a la naturaleza atom\'istica subyacente. En este contexto, suelen encontrarse referencias a descripciones microsc\'opicas, mesosc\'opicas o macrosc\'opicas. La descripci\'on microsc\'opica, por un lado, hace referencia a una descripci\'on molecular, mientras que la macrosc\'opica involucra una visi\'on continua completa, con cantidades tangibles como densidad o velocidad del fluido. Por otro lado, entre ambas aproximaciones se encuentra la teor\'ia cin\'etica mesosc\'opica, la cu\'al no describe el movimiento de part\'iculas individuales, sino de distribuciones o colecciones representativas de dichas part\'iculas.
\par
La variable fundamental de la teor\'ia cin\'etica se conoce como funci\'on de distribuci\'on de part\'iculas (\emph{particle distribution function}, o pdf por sus siglas en ingl\'es), que puede verse como una generalizaci\'on de la densidad $\rho$ y que a su vez tiene en cuenta la velocidad microsc\'opica de las part\'iculas $\bm{\xi}$. Por lo tanto, mientras que $\rho(\bm{x},t)$ representa la densidad de masa en el espacio f\'isico, la funci\'on de distribuci\'on \fvar{} corresponde a la densidad de masa tanto en el espacio f\'isico como en el espacio de velocidades.
\par
La funci\'on de distribuci\'on $f$ se relaciona con variables macrosc\'opicas como densidad $\rho$ y velocidad $\bm{u}$ a trav\'es de momentos, es decir, integrales de $f$ con funciones de peso dependientes de \bxi{} sobre todo el espacio de velocidades. En particular, la densidad de masa macrosc\'opica puede obtenerse como el momento

\begin{equation}
	\rho(\bm{x},t) = \int f(\bm{x},\bm{\xi},t) \, d^3 \xi,
\end{equation}
en el cual se considera la contribuci\'on de part\'iculas con todas las velocidades posibles en la posici\'on $\bm{x}$ a tiempo $t$. Por otro lado, puede determinarse la densidad de impulso mediante
\begin{equation}
	\rho(\bm{x},t) \bm{u}(\bm{x},t) = \int \bm{\xi} f(\bm{x},\bm{\xi},t) \, d^3 \xi.
\end{equation}

De forma similar, la densidad de energ\'ia total corresponde al momento
\begin{equation}
	\rho(\bm{x},t) E(\bm{x},t) = \dfrac{1}{2} \int |\bm{\xi}|^2 f(\bm{x},\bm{\xi},t) \, d^3 \xi.
\end{equation}


\subsection{Funci\'on de distribuci\'on de equilibrio}
En el an\'alisis original realizado para gases iluidos y monoat\'omicos, Maxwell menciona que cuando un gas permanece sin perturbaciones por un per\'iodo de tiempo suficientemente largo, la funci\'on de distribuci\'on \fvar{} alcanza una distribuci\'on de equilibrio \feqvar{} que es isotr\'opica en el espacio de velocidades en torno a $\bm{\xi} = \bm{u}$. De esta manera, si te toma un marco de referencia que se desplaza con velocidad $\bm{u}$, entonces dicha distribuci\'on de equilibrio puede expresarse como $f^{eq}(\bm{x},|\bm{v}|,t)$. Por otro lado, si se supone que la distribuci\'on de equilibrio puede expresarse de forma separable, es decir 

\begin{equation}
	f^{eq}(|\bm{v}|^2) = f^{eq}(v_x^2 + v_y^2 + v_z^2)=f_{1D}^{eq}(v_x^2) \, f_{1D}^{eq}(v_y^2) \, f_{1D}^{eq}(v_z^2),
\end{equation}
entonces puede demostrarse que dicha distribuci\'on queda definida como

\begin{equation}
	f^{eq}(\bm{x},|\bm{v}|^2,t) = \mbox{e}^{3a}\mbox{e}^{b|\bm{v}|^2}.
\end{equation}
Por otro lado, considerando que las colisiones monoa\'omicas conservan masa, momento y energ\'ia, y usando adem\'as la relaci\'on de gases ideales:
\begin{equation}
	\rho e = \frac{3}{2}RT=\frac{3}{2}p,
\end{equation}
finalmente puede encontrarse una expresi\'on expl\'icita para la distribuci\'on de equilibrio
\begin{equation}
	f^{eq}(\bm{x},|\bm{v}|,t) 
	= \rho \left( \dfrac{3}{4\pi e} \right)^{3/2} \mbox{e}^{-3|\bm{v}|^2/(4e)}
	= \rho \left( \dfrac{1}{2\pi RT} \right)^{3/2} \mbox{e}^{-|\bm{v}|^2/(2RT)}
\end{equation}

\subsection{La ecuaci\'on de Boltzmann}
La funci\'on de distribuci\'on \fvar{} establece propiedades tangibles de un fluido a trav\'es de sus diferentes momentos. Asimismo, es posible determinar una ecuaci\'on que permita modelar su evoluci\'on en el espacio f\'isico, de velocidades, y el tiempo. En el an\'alisis siguiente, se omitir\'a la dependencia de $f$ con $(\bm{x}, \bm{\xi}, t)$ por claridad.
\par
Como $f$ es una funci\'on de la posici\'on $\bm{x}$, de la velocidad de las part\'iculas \bxi{}, y del tiempo $t$, la derivada total respecto al tiempo resulta

\begin{equation}
	\dfrac{df}{dt} = \left( \dfrac{\partial f}{\partial t} \right) \dfrac{dt}{dt}
	               + \left( \dfrac{\partial f}{\partial x_{\beta}} \right) \dfrac{dx_{\beta}}{dt}
	               + \left( \dfrac{\partial f}{\partial \xi_{\beta}} \right) \dfrac{d\xi_{\beta}}{dt}.
\end{equation}

En este caso $dt/dt = 1$, la velocidad de las part\'iculas se obtiene como $dx_{\beta}/dt = \xi_{\beta}$, y la fuerza volum\'etrica $\bm{F}$ queda determinada por la segunda ley de Newton $d\xi_{\beta}/dt = F_{\beta}/\rho$. Utilizando la notaci\'on tradicional $\Omega (f) = df/dt$ para el diferencial total respecto al tiempo, se obtiene la ecuaci\'on de Boltzmann para describir la evoluci\'on de $f$:

\begin{equation}
	\dfrac{\partial f}{\partial t}  +  \xi_{\beta} \dfrac{\partial f}{\partial x_{\beta}}            +  \dfrac{F_{\beta}}{\rho} \dfrac{\partial f}{\partial \xi_{\beta}} =\Omega(f).
	\label{eq:boltz}
\end{equation}

La \eq{eq:boltz} puede verse como una ecuaci\'on de advecci\'on para $f$, donde los dos primeros t\'erminos del miembro izquierdo corresponden a la advecci\'on de $f$ con la velocidad de part\'iculas \bxi{}, mientras que el tercero representa el efecto de las fuerzas externas. Por otro lado, el miembro derecho contiene un t\'ermino de fuente conocido como operador de colisi\'on, que representa la redistribuci\'on local de $f$ debido a colisiones entre las propias part\'iculas. Estas colisiones conservan masa, momento y energ\'ia, lo que se traduce en restricciones para los momentos de $\Omega$:
\begin{subequations}
	\begin{align}
		\int \Omega(f) \, d^3 \xi = 0 \\
		\int \bm{\xi} \, \Omega(f) \, d^3 \xi = \bm{0} \\		
		\int |\bm{\xi}|^2 \, \Omega(f) \, d^3 \xi = 0 	
	\end{align}
	\label{eq:omega_restrict}
\end{subequations}


\subsection{Ecuaciones de conservaci\'on macrosc\'opicas}
Las ecuaciones de conservaci\'on macrosc\'opicas pueden obtenerse como momentos de la ecuaci\'on de Boltzmann, es decir, multiplicando la \eq{eq:boltz} por funciones de \bxi{} e integrando sobre todo el espacio de velocidades. Para ello, es necesario introducir una notaci\'on general para los momentos de $f$

\begin{subequations}
	\begin{equation}
		\Pi_0 = \int f \, d^3 \xi = \rho
	\end{equation}
	\begin{equation}
		\Pi_{\alpha} = \int \xi_{\alpha} f \, d^3 \xi = \rho u_{\alpha}
	\end{equation}
	\begin{equation}
		\Pi_{\alpha \beta} = \int \xi_{\alpha} \xi_{\beta} f \, d^3 \xi
	\end{equation}
	\begin{equation}
		\Pi_{\alpha \beta \gamma} = \int \xi_{\alpha} \xi_{\beta} \xi_{\gamma} f \, d^3 \xi
	\end{equation}
	\label{eq:f_moments}
\end{subequations}

La ecuaci\'on m\'as simple de obtener corresponde a la de conservaci\'on de masa. Integrando la \eq{eq:boltz} en el espacio de velocidades, y usando las \eqs{eq:omega_restrict}{eq:f_moments}, se obtiene:

\begin{equation}
	\dfrac{\partial \rho}{\partial t} + \dfrac{\partial (\rho u_{\beta})}{\partial x_{\beta}} = 0.
\end{equation}

De manera similar, multiplicando la \eq{eq:boltz} por $\xi_{\alpha}$ e integrando en el espacio de velocidades se obtiene la ecuaci\'on de conservaci\'on de momento:

\begin{equation}
	\dfrac{\partial \rho u_{\alpha}}{\partial t} + \dfrac{\partial \Pi_{\alpha \beta}}{\partial x_{\beta}} = F_{\alpha}.
	\label{eq:mom_flux}
\end{equation}
donde $\Pi_{\alpha \beta}$ se define como el tensor de flujo de impulso. Si se descompone la velocidad de las part\'iculas como $\bm{xi} = \bm{u} + \bm{v}$, entonces la \eq{eq:mom_flux} puede reescribirse como

\begin{equation}
	\dfrac{\partial \rho u_{\alpha}}{\partial t} 
	+ \dfrac{\partial (\rho u_{\alpha} u_{\beta})}{\partial x_{\beta}} = 
	\dfrac{\partial \sigma_{\alpha \beta}}{\partial x_{\beta}} + F_{\alpha}.
	\label{eq:impulso}
\end{equation}
con $\sigma_{\alpha \beta}$ representando el tensor de tensiones:

\begin{equation}
	\sigma_{\alpha \beta} = -\int v_{\alpha} v_{\beta} f \, d^3 \xi
\end{equation}

Finalmente, puede seguirse un procedimiento similar para encontrar una ecuaci\'on macrosc\'opica de conservaci\'on de energ\'ia. Multiplicando la \eq{eq:boltz} por $\xi_{\alpha} \xi_{\beta}$ e integrando en el espacio de velocidades se obtiene:

\begin{equation}
	\dfrac{\partial \rho E}{\partial t} + \dfrac{1}{2} \dfrac{\Pi_{\alpha\alpha\beta}}{\partial x_{\beta}} = F_{\beta} u_{\beta}.
	\label{eq:energy_flux}
\end{equation}

Descomponiendo el momento como en la ecuaci\'on de conservaci\'on de impulso y usando la \eq{eq:impulso} multiplicada por $u_{\alpha}$, la \eq{eq:energy_flux} puede reescribirse como:

\begin{equation}
	\dfrac{\partial \rho e}{\partial t} + \dfrac{(\rho u_{\beta} e)}{\partial x_{\beta}} = \sigma_{\alpha\beta} \dfrac{\partial u_{\alpha}}{\partial x_{\beta}} - \dfrac{\partial q_{\beta}}{\partial x_{\beta}},
\end{equation}
donde el flujo de calor $\bm{q}$ est\'a definido por el momento

\begin{equation}
	q_{\beta} = \dfrac{1}{2} \int v_{\alpha} v_{\alpha} v_{\beta} f \, d^3 \xi
\end{equation}


En este punto es interesante destacar que si bien la convervaci\'on de masa queda definida exactamente, las ecuaciones de impulso y energ\'ia dependen de la forma de $f$, que todav\'ia no es conocida. En el caso particular en que $f \simeq f^{eq}$, se obtienen las ecuaciones de Euler para impulso y energ\'ia:

\begin{subequations}
	\begin{equation}
	 	\dfrac{\partial \rho u_{\alpha}}{\partial t} 
	  + \dfrac{\partial (\rho u_{\alpha} u_{\beta})}{\partial x_{\beta}} 
	  =	-\dfrac{\partial p}{\partial x_{\alpha}} + F_{\alpha} 	
	\end{equation}
	\begin{equation}
		\dfrac{\partial \rho e}{\partial t} 
	  + \dfrac{(\rho u_{\beta} e)}{\partial x_{\beta}} 
	  = -p \dfrac{\partial u_{\beta}}{\partial x_{\beta}} 	
	\end{equation}
\end{subequations}

Este hecho muestra que los procesos macrosc\'opicos de disipaci\'on viscosa y difusi\'on de calor se encuentran directamente vinculados a la desviaci\'on de $f$ respecto de su valor de equilibrio.



\section{Discretizaci\'on del espacio de velocidades} 
El desarrollo mostrado en la \se{sec:kinetic} evidencia la posibilidad de representar adecuadamente el comportamiento de un fluido usando una funci\'on de distribuci\'on \fvar{}. Sin embargo, dicha distribuci\'on se encuentra definida en un espacio con 7 dimensiones, es decir, 3 coordenadas espaciales, 3 para el espacio de velocidades, y una para el tiempo, de modo que la resoluci\'on de ecuaciones en este espacio multidimensional involucra un esfuerzo computacional considerable. Por otro lado, es necesario considerar que este enfoque no es siempre justificable, dado que en definitiva son los momentos de la ecuaci\'on de Boltzmann (integrales en el espacio de velocidades) los que conducen a ecuaciones macrosc\'opicas de conservaci\'on de masa, impulso y energ\'ia. 
\par 
Estas caracter\'isticas originaron la b\'usqueda de versiones simplificadas de la ecuaci\'on de Boltzmann que no sacrifiquen el comportamiento macrosc\'opico, es decir, de sus momentos. Entre estas alternativas podemos encontrar las expansiones en base al n\'umero de Mach \cite{he_lattice_1997} o en series de Hermite \cite{shan_kinetic_2006}. Si bien ambas conducen a la misma representaci\'on de Navier-Stokes, la representaci\'on en series de Hermite presenta una base matem\'atica m\'as s\'olida, y es la que se utilizar\'a a continuaci\'on.
\par
La idea fundamental de la espansi\'on usando polinomios de Hermite consiste en simplificar la funci\'on de distribuci\'on de equilibrio $f^{eq}$ y discretizar el espacio de velocidades, pero manteniendo las leyes de conservaci\'on macrosc\'opicas. En particular, como $f^{eq}$ tiene una forma exponencial conocida, puede ser expresada a trav\'es de la funci\'on generatriz de dichos polinomios. Por otro lado, los momentos de masa e impulso son representados como integrales discretas de $f^{eq}$ usando los polinomios de Hermite.


\subsection{Adimensionalizaci\'on}
Antes de proceder con la discretizaci\'on de $f$ y $f^{eq}$ en series de Hermite, es conveniente reescribir las ecuaciones governantes de forma adimensional, con el objetivo de simplificar los pasos siguientes.
\par
La funci\'on de distribuci\'on \fvar{} representa la densidad de masa en el espacio f\'isico tridimensional y en el espacio de velocidades, tambi\'en tridimensional. Por lo tanto, las unidades de $f$ en el SI son:
\begin{equation}
	[f] = \mbox{kg} \times \dfrac{1}{\mbox{m}^3} \times \dfrac{1}{(\mbox{m/s})^3} = \dfrac{\mbox{kg} \, \mbox{s}^3}{\mbox{m}^6}.
\end{equation}

Las propiedades de un fluido pueden analizarse en t\'erminos de una longitud caracter\'istica $l$, velocidad caracter\'istica $V$ y densidad caracter\'istica $\rho_0$. Si se denota con * a las cantidades adimensionales, entonces podemos escribir los operadores diferenciales adimensionales como:
\begin{equation}
\dfrac{\partial}{\partial t^*} = \dfrac{l}{V}\dfrac{\partial}{\partial t}, \qquad
\dfrac{\partial}{\partial x^*} = l\dfrac{\partial}{\partial x}, \qquad
\dfrac{\partial}{\partial \xi^*} = V\dfrac{\partial}{\partial \xi}.
\end{equation}

Esto lleva a escribir a la forma adimensional de la ecuaci\'on de Boltzmann:
\begin{equation}
	\dfrac{\partial f^*}{\partial t^*}  
	+  \xi^*_{\alpha} \dfrac{\partial f^*}{\partial x^*_{\alpha}} 
	+  \dfrac{F^*_{\alpha}}{\rho^*} \dfrac{\partial f^*}{\partial \xi^*_{\alpha}} =\Omega^*(f^*),
	\label{eq:boltz_adim}
\end{equation}
donde $f^* = fV^d/\rho_0$, $\bm{F}^* = \bm{F}l/(\rho_0 V^2)$, $\rho^2 = \rho/\rho_0$ y $\Omega^*= \Omega l V^2 / \rho_0$. Siguiendo el mismo procedimiento, la funci\'on de equilibrio adimensional resulta:
\begin{equation}
	f^{eq*}	= \left( \dfrac{\rho^*}{2\pi \theta^*} \right)^{d/2} \mbox{e}^{-(\bm{\xi}^* - \bm{u}^*)^2/(2\theta^*)}
\end{equation}

En este caso, $\theta^*$ corresponde a la temperatura adimensional $\theta^*=RT/V^2$. En las secciones siguientes se trabajar\'a exclusivamente con cantidades adimensionales, omitiendo el super\'indice * por claridad.


\subsection{Expansi\'on en series de Hermite}
Las bases de la teor\'ia cin\'etica muestran que el operador de colisi\'on preserva ciertos momentos de la funci\'on de distribuci\'on, lo que a su vez implica que los momentos de $f^{eq}$ y $f$ deben coincidir:
\begin{subequations}
	\begin{align}
		\int f(\bm{x},\bm{\xi},t) \, d^3 \xi &=& \int f^{eq}(\rho, \bm{u},\theta,\bm{\xi}) \, d^3 \xi &=& \rho(\bm{x},t)\\
		\int f(\bm{x},\bm{\xi},t) \bm{xi}\, d^3 \xi &=& \int f^{eq}(\rho, \bm{u},\theta,\bm{\xi}) \bm{xi}\, d^3 \xi &=& \rho(\bm{x},t)\bm{u}(\bm{x},t)\\
		\int f(\bm{x},\bm{\xi},t) \dfrac{|\bm{\xi}|^2}{2} \, d^3 \xi &=& \int f^{eq}(\rho, \bm{u},\theta,\bm{\xi}) \dfrac{|\bm{\xi}|^2}{2} \, d^3 \xi &=& \rho(\bm{x},t)E(\bm{x},t)\\		
		\int f(\bm{x},\bm{\xi},t) \dfrac{|\bm{\xi}-\bm{u}|^2}{2} \, d^3 \xi &=& \int f^{eq}(\rho, \bm{u},\theta,\bm{\xi}) \dfrac{|\bm{\xi}-\bm{u}|^2}{2} \, d^3 \xi &=& \rho(\bm{x},t)e(\bm{x},t)		
	\end{align}
	\label{eq:cons_moments}	
\end{subequations}

Las cantidades conservadas de la \eq{eq:cons_moments} pueden obtenerse como integrales de $f$ o $f^{eq}$ en el espacio de velocidades. Por lo tanto, la expansi\'on en series de Hermite contribuye a transformar esas integrales continuas en sumas discretas evaluadas en puntos espec\'ificos del espacio de velocidades.
\par
Los polinomios de Hermite se definen en un espacio $d$-dimensional como: \cite{shan_kinetic_2006,grad_kinetic_1949}
\begin{equation}
	\bm{H}^{(n)} (\bm{x})= (-1)^n\dfrac{1}{\omega (\bm{x})} \bm{\nabla}^{(n)}\omega(\bm{x}),
\end{equation}
donde $\omega(\bm{x})$ es una funci\'on generatriz:
\begin{equation}
	\omega(\bm{x}) = \dfrac{1}{(2\pi)^{d/2}}\mbox{e}^{-\bm{x}^2/2}
\end{equation}

Tanto $\bm{H}^{(n)}$ como $\bm{\nabla}^{(n)}$ son tensores de rango $n$, de modo que sus $d^n$ componentes pueden expresarse como $H^{(n)}_{\alpha_1 \ldots \alpha_n}$ y $\nabla^{(n)}_{\alpha_1 \ldots \alpha_n}$, donde $\{\alpha_1 \ldots \alpha_n\}$ son \'indices comprendidos entre $1$ y $d$. Para el caso particular de una dimensi\'on, los polinomios se reducen a
\begin{equation}
	H^{(n)}(x)=(-1)^{(n)} \dfrac{1}{\omega(x)} \dfrac{d^n}{dx^n}\omega(x), \qquad 
	\omega(x) = \dfrac{1}{\sqrt{2\pi}}\mbox{e}^{-x^2/2}
\end{equation}

Los polinomios de Hermite son ortogonales respecto a la funci\'on de peso $\omega(\bm{x})$ y constituyen una base completa en $\Re^n$ \cite{wiener_fourier_1989}, de modo que es posible representar cualquier funci\'on $f(\bm{x})$ suficientemente suave mediante:
\begin{equation}
	f(\bm{x}) = \omega(\bm{x}) \sum_{n=0}^{\infty}\dfrac{1}{n!}\bm{a}^{(n)} \cdot \bm{H}^{(n)}(\bm{x}), \qquad 
	\bm{a}^{(n)} = \int f(\bm{x})\bm{H}^{(n)}(\bm{x}) d^nx
\end{equation}

Esta propiedad permite aplicar la expansi\'on en series de Hermite a la funci\'on de distribuci\'on de equilibrio en el espacio de velocidades
\begin{subequations}
	\begin{equation}
		f^{eq}(\rho, \bm{u}, \theta, \bm{\xi}) = \omega(\bm{\xi}) \sum_{n=0}^{\infty}\dfrac{1}{n!}\bm{a}^{(n)eq}(\rho, \bm{u}, \theta) \cdot \bm{H}^{(n)}(\bm{\xi})
	\end{equation}
	\begin{equation}
		\bm{a}^{(n)eq}(\rho, \bm{u}, \theta) = \int f^{eq}(\rho, \bm{u}, \theta, \bm{\xi})\bm{H}^{(n)}(\bm{\xi}) \mbox{d}^d \xi
	\end{equation}
	\label{eq:feq_hermite}
\end{subequations}

En particular, puede verse que la funci\'on de distribuci\'on de equilibrio tiene la misma forma funcional que la funci\'on generatriz $\omega(\bm{x})$
\begin{equation}
	f^{eq}(\rho, \bm{u}, \theta, \bm{\xi}) = \dfrac{\rho}{\theta^{d/2}} \, \omega \left( \dfrac{\bm{\xi} - \bm{u}}{\sqrt{\theta}} \right),
\end{equation}
de modo que el c\'alculo de los coeficientes $\bm{a}^{(n)}$ puede simplificarse mediante:
\begin{equation}
	\bm{a}^{(n)eq} = \rho \int \omega(\bm{\eta})\bm{H}^{(n)}(\sqrt{\theta}\bm{\eta} - \bm{u}) \mbox{d}^d \eta,
\end{equation}
donde $\bm{\eta} = (\bm{\xi} - \bm{u})/\sqrt{\theta}$. El c\'alculo de estas integrales puede realizarse directamente, de modo que los primeros coeficientes resultan:
\begin{subequations}
	\begin{align}
		a^{(0),eq}          &= \rho              \\ 
		a^{(1),eq}_{\alpha} &= \rho u_{\alpha}   \\
		a^{(2),eq}_{\alpha\beta} &= \rho \left[ u_{\alpha} u_{\beta} + (\theta-1)\delta_{\alpha\beta} \right]   \\
		a^{(3),eq}_{\alpha\beta\gamma} &= \rho \left[ u_{\alpha} u_{\beta} u_{\gamma} + (\theta-1)(\delta_{\alpha\beta}u_{\gamma} + \delta_{\beta\gamma}u_{\alpha} + \delta_{\gamma\alpha}u_{\beta}) \right].
	\end{align}
	\label{eq:eq_coeffs}
\end{subequations}

A partir de la \eq{eq:eq_coeffs} puede observarse que los coeficientes de la serie de Hermite est\'an directamente relacionados con las principales cantidades conservadas. En esta l\'inea, puede demostrarse que existe una relaci\'on similar para los coeficientes de la expansi\'on en series de Hermite de la funci\'on de distribuci\'on $f$:
\begin{subequations}
	\begin{align}
		a^{(0),eq} &= \int f^{eq} \mbox{d}^d \xi  &= \rho  &= \int f \mbox{d}^d \xi &= a^{(0)}   \\ 
		a^{(1),eq}_{\alpha} &= \int \xi_{\alpha}f^{eq} \mbox{d}^d \xi  &= \rho u_{\alpha}  &= \int \xi_{\alpha}f \mbox{d}^d \xi &= a^{(1)}_{\alpha}   \\ 		
		\dfrac{a^{(2),eq}_{\alpha\alpha}+\rho d}{2} &= \int \dfrac{|\bm{\xi}|^2}{2} f^{eq} \mbox{d}^d \xi  &= \rho E  &= \int \dfrac{|\bm{\xi}|^2}{2} f \mbox{d}^d \xi &= \dfrac{a^{(2)}_{\alpha\alpha}+\rho d}{2}
	\end{align}
\end{subequations}

La representaci\'on adecuada de las leyes de conservaci\'on macrosc\'opica puede alcanzarse con pocos t\'erminos de las series de Hermite, aunque se ha observado que la inclusi\'on de t\'erminos de mayor orden contribuyen a mejorar la precisi\'on y estabilidad del m\'etodo num\'erico final \cite{dhumieres_multiple-relaxation-time_2002}. De esta forma, la representaci\'on en serie de $f^{eq}$ con s\'olo $N=3$ t\'erminos puede aproximarse por:
\begin{align}
	f^{eq} &\approx \omega(\bm{\xi}) \sum_{n=0}^{N=3} \dfrac{1}{n!}\bm{a}^{(n),eq} \cdot \bm{H}^{(n)}(\bm{\xi}) \\
	&\approx \omega(\bm{\xi}) \rho \left[ 1 + \xi_{\alpha}u_{\alpha} + \left( u_{\alpha}u_{\beta}+(\theta-1)\delta_{\alpha\beta} \right)\left(\xi_{\alpha}\xi_{\beta} - \delta_{\alpha\beta}\right) \right]
\end{align}


\subsection{Discretizaci\'on de la funci\'on de distribuci\'on de equilibrio}

La expansi\'on de la funci\'on de distribuci\'on de equilibrio \feqvar{} en series de Hermite es apropiada, ya que la forma funcional de $f^{eq}(\bm{\xi})$ es similar a la de la funci\'on generatriz $\omega(\bm{xi})$, y los primeros coeficientes de la serie est\'an directamente relacionados con los principales momentos conservados (densidad, velocidad y energ\'ia). Por otro lado, el empleo de polinomios de Hermite permite calcular integrales de determinadas funciones utilizando la evaluaci\'on de dicha funci\'on en un intervalo discreto de puntos (abscisas), mediante la regla conocida como cuadratura de Gauss-Hermite. En particular, esta t\'ecnica permite calcular exactamente ciertas integrales de polinomios mediante:
\begin{equation}
	\int \omega(\bm{x}) P^{(N)}(\bm{x})\mbox{d}^dx = \sum_{i=1}^{n} w_i P^{(N)}(\bm{x}_i)
\end{equation}
donde $P^{(N)}$ es un polinomio de grado $N$, $n$ es al menos $n=(N+1)/2$, y $w_i$ son pesos asociados a las abscisas $\bm{x}_i$. En este caso, cada componente del punto multidimensional $\bm{x}_i$, es decir, $x_{i\alpha}$ con $\alpha=1\ldots d$, es una ra\'iz del polinomio de Hermite unidimensional $H^{n}(x_{i\alpha})=0$. De esta forma, la cuadratura de Gauss-Hermite puede usarse para reescribir los coeficientes de la serie de $f^{eq}$ mediante un conjunto discreto de velocidades $\{ \bm{\xi}_i \}$:
\begin{equation}
	\bm{a}^{(n),eq} = \int f^{eq}(\bm{\xi}) \bm{H}^{(n)}(\bm{\xi}) \mbox{d}^d \xi 
	= \rho \sum_{i=1}^n w_i Q(\bm{\xi}_i)\bm{H}^{(n)}(\bm{\xi}_i)
\end{equation}

Esta discretizaci\'on lleva a describir $n$ cantidades $f_i^{eq}(\bm{x},t)$, correspondientes a la funci\'on de distribuci\'on de equilibrio evaluada en la velocidad $\bm{\xi}_i$. Por lo tanto, podemos reemplazar a la funci\'on continua $f^{eq}(\bm{\xi})$ por un conjunto discreto
\begin{equation}
	f_i^{eq} = w_i \rho \left[ 1 + \xi_{i\alpha}u_{\alpha} + \dfrac{1}{2}\left( u_{\alpha}u_{\beta}+(\theta-1)\delta_{\alpha\beta} \right)\left(\xi_{i\alpha}\xi_{i\beta} - \delta_{\alpha\beta}\right) \right]
\end{equation}
\par
El conjunto ${f_i^{eq}}$ es continuo en espacio y tiempo, y satisface las mismas leyes de conservaci\'on para los primeros tres momentos de $f^{eq}(\bm{\xi})$. Finalmente, asumiendo un comportamiento isot\'ermico ($\theta = 1$) y reescribiendo las velocidades de las part\'iculas como
\begin{equation}
	\bm{e}_i = \dfrac{\bm{\xi}_i}{\sqrt{3}},
\end{equation}
podemos escribir una forma final para la distribuci\'on de equilibrio discreta:
\begin{equation}
	f_i^{eq} = w_i \rho \left[ 1 + \dfrac{e_{i\alpha}u_{\alpha}}{c_s^2} + \dfrac{u_{\alpha}u_{\beta}(e_{i\alpha}e_{i\beta}-c_s^2\delta_{\alpha\beta})}{2c_s^4} \right]
\end{equation}
donde adem\'as se defini\'o convenientemente a la constante $c_s$, llamada velocidad del sonido.


\subsection{Discretizaci\'on de la funci\'on de distribuci\'on}
El procedimiento aplicado para aproximar la dependencia de $f^{eq}$ en el espacio de velocidades $\bm{\xi}$ tambi\'en puede ser usado con la funci\'on de distribuci\'on $f$:
\begin{equation}
	\bm{a}^{(n)}(\bm{x},t) = \int f(\bm{x}, \bm{e}, t) \bm{H}^{(n)}(\bm{e}) \, \mbox{d}^d e \approx \sum_{i=1}^q f_i(\bm{x},t)\bm{H}^{(n)}(\bm{e}_i)
\end{equation}

Ahora se tiene un conjunto de $q$ funciones $f_i(\bm{x},t)$, relacionadas con las velocidades discretas $\bm{e}_i$ y continuas en el espacio y tiempo. Usando este conjunto es posible reescribir la ecuaci\'on de Boltzmann, pero esta vez discreta en el espacio de velocidades:
\begin{equation}
	\partial_t f_i + e_{i\alpha} \partial_{\alpha} f_{i} = \Omega(f_i), \qquad i=1\ldots q,
	\label{eq:boltz_disc_vel}
\end{equation}
donde los momentos macrosc\'opicos se pueden calcular usando sumas discretas:
\begin{subequations}
	\begin{equation}
		\rho        = \sum_i f_i          = \sum_i f_i^{eq}
	\end{equation}
	\begin{equation}
		\rho \bm{u} = \sum_i f_i\bm{e}_i  = \sum_i f_i^{eq}\bm{e}_i
	\end{equation}
\end{subequations}


\subsection{Conjunto discreto de velocidades}
La descomposici\'on de las funciones de distribuci\'on usando series de Hermite mostr\'o que el espacio de velocidades puede ser discretizado, pero hasta este punto no se estableci\'o de qu\'e manera. Los conjuntos de velocidades $\{\bm{e}_i\}$ admisibles deben cumplir dos propiedades fundamentales; por un lado, presentar una resoluci\'on suficiente que permita capturar los fen\'omenos f\'isicos deseados, y por otro contener la menor cantidad de componentes posibles para reducir el costo computacional involucrado. 
\par 
Tradicionalmente, los conjuntos de velocidades suelen identificarse con la notaci\'on D$d$Q$q$ introducida por \cite{qian_lattice_1992}, donde $d$ corresponde al n\'umero de dimensiones espaciales y $q$ a la cantidad de velocidades discretas. Estos conjuntos quedan determinados por las velocidades $\{\bm{e}_i\}$, los pesos $\{w_i\}$ y la velocidad del sonido $c_s^2$. Si bien existen numerosos mecanismos para construir conjuntos de velocidades con las propiedades deseadas, la alternativa m\'as sencilla y directa consiste en evaluar la isotrop\'ia rotacional de los tensores de grilla \cite{guo_lattice_2013,frisch_lattice_1987}, es decir, de aquellos momentos con factores de peso $\{w_i\}$. Esta simetr\'ia implica que los tensores de grilla de hasta orden 5 satisfagan
\begin{subequations}
	\begin{align}
	\sum_i w_i &= 1 \\
	\sum_i w_i e_{i\alpha} &= 0 \\
	\sum_i w_i e_{i\alpha} e_{i\beta} &= c_s^2 \delta_{\alpha\beta} \\
	\sum_i w_i e_{i\alpha} e_{i\beta} e_{i\gamma} &= 0 \\
	\sum_i w_i e_{i\alpha} e_{i\beta} e_{i\gamma} e_{i\mu} &= c_s^4(\delta_{\alpha\beta}\delta_{\gamma\mu} + \delta_{\alpha\gamma}\delta_{\beta\mu} + \delta_{\alpha\mu}\delta_{\beta\gamma}) \\
	\sum_i w_i e_{i\alpha} e_{i\beta} e_{i\gamma} e_{i\mu} e_{i\nu} &= 0.
	\end{align}
	\label{eq:tensores_grilla}	
\end{subequations}

Una vez establecidas este tipo de restricciones, el procedimiento habitual consiste en definir el conjunto de velocidades discretas, y posteriormente determinar $\{w_i\}$ y $c_s^2$. La dimensi\'on de $\{ \bm{e}_i\}$ depender\'a de la cantidad de restricciones de la \eq{eq:tensores_grilla} que quieran satisfacerse simult\'aneamente: para resolver adecuadamente ecuaciones macrosc\'opicas como Navier-Stokes se necesita cumplir con los primeros 6 tensores de grilla, mientras que para ecuaciones de advecci\'on-difusi\'on lineales, alcanza con satisfacer los primeros 4.
\par
La \eq{eq:boltz_disc_vel} suele discretizarse grillas espaciales regulares de espaciado $\Delta x$, y en intervalos de tiempo regulares $\Delta t$. Por lo tanto, es conveniente elegir el conjunto de velocidades $\{e\}_i$ de modo que conecten exclusivamente nodos vecinos. De esta forma surgen los modelos de grilla tradicionales como D1Q3, D2Q9 y D3Q15, los cuales se ilustran en la \textbf{figura de velocidades de grilla}. En la \tb{tab:DdQq} se resumen las principales propiedades de cada modelo de grilla.

\begin{table}[ht]
	\centering
    \begin{tabular}{c c c c}
	    \toprule
        \bf Modelo & $\{\bm{e}_i\}$ & $\{w_i\}$ & $c_s^2$ \\
        \midrule
        \multirow{2}{*}{D1Q3} & (0)      & 2/3 & \multirow{2}{*}{1/$\sqrt{3}$} \\
                              & ($\pm$1) & 1/6 &  \\                 
        \midrule
        \multirow{3}{*}{D2Q9} & (0,0) & 4/9 & \multirow{3}{*}{1/$\sqrt{3}$} \\
                              & ($\pm$1,0), (0,$\pm$1) & 1/9 &  \\
                              & ($\pm$1,$\pm$1) & 1/36 &  \\                              
        \midrule
        \multirow{3}{*}{D3Q15} & (0,0,0) & 2/9 & \multirow{3}{*}{1/$\sqrt{3}$} \\
                               & ($\pm$1,0,0), (0,$\pm$1,0), (0,0,$\pm$1) & 1/9 &  \\
                               & ($\pm$1,$\pm$1,$\pm$1) & 1/72 &  \\         
        \bottomrule
	\end{tabular}
	\caption{Ejemplos de conjuntos de velocidades}
	\label{tab:DdQq}
\end{table}  


\section{Discretizaci\'on del espacio y tiempo}  
Hasta este punto, s\'olo se aplic\'o la discretizaci\'on de la ecuaci\'on de Boltzmann en el espacio de velocidades. El paso final hacia la ELB debe completarse con la discretizaci\'on del espacio y tiempo.
\par 
La ecuaci\'on de Boltzman discreta (\eq{eq:boltz_disc_vel}) es una ecuaci\'on diferencial en derivadas parciales (EDP) de primer orden y parab\'olica. Una de las t\'ecnicas m\'as usadas en la resoluci\'on de este tipo de ecuaciones es aquella que se conoce como m\'etodo de las caracter\'isticas, que consiste en parametrizar las variables independientes de la EDP para transformarla en una ecuaci\'on diferencial ordinaria (EDO). En este caso, es posible expresar la soluci\'on de \ref{eq:boltz_disc_vel} como $f_i=f_i(\bm{x}(\zeta),t(\zeta))$, donde $\zeta$ parametriza una trayectoria en el espacio. De esta manera, la \eqref{eq:boltz_disc_vel} puede reescribirse usando un diferencial total:
\begin{equation}
	\dfrac{df}{d\zeta} = \dfrac{\partial f}{\partial t}\dfrac{\partial t}{\partial \zeta} + \dfrac{\partial f}{\partial x_{\alpha}}\dfrac{\partial x_{\alpha}}{\partial \zeta} = \Omega_i(\bm{x}(\zeta),t(\zeta))
	\label{eq:zeta_total}
\end{equation}

Por inspecci\'on, debe cumplirse
\begin{equation}
	\dfrac{\partial t}{\partial \zeta} = 1, \qquad
	\dfrac{\partial x_{\alpha}}{\partial \zeta} = e_{i\alpha}.
\end{equation}
de modo que las soluciones $f_i$ siguen una trayectoria dada por $\bm{x}=\bm{x}_0 + \bm{e_i}t$, donde $\bm{x}_0$ es una constante arbitraria. Si se considera la trayectoria que pasa a trav\'es del punto $(\bm{x}_0,t_0)$, con $t(\zeta=0)=t_0$ y $\bm{x}(\zeta=0)=\bm{x}_0$, entonces la integraci\'on de la \eq{eq:zeta_total} resulta:
\begin{equation}
	f_i(\bm{x}_0+\bm{e_i}\Delta t,t_0+\Delta t)-f_i(\bm{x}_0,t_0)=\int_0^{\Delta t}\Omega_i(\bm{x}_0+\bm{e_i}\zeta,t_0+\zeta) \, \mbox{d}\zeta.
\end{equation}

Como el punto $(\bm{x}_0,t_0)$ es arbitrario, la integraci\'on puede generalizarse como:
\begin{equation}
	f_i(\bm{x}+\bm{e_i}\Delta t,t+\Delta t)-f_i(\bm{x},t)=\int_0^{\Delta t}\Omega_i(\bm{x}+\bm{e_i}\zeta,t+\zeta) \, \mbox{d}\zeta.
	\label{eq:elb_integral}
\end{equation}

A partir de la integraci\'on de la \eq{eq:elb_integral} resulta explicito el acople entre la discretizaci\'on espacial y temporal, y refuerza la practicidad de emplear conjuntos de velocidades que, en un intervalo de tiempo $\Delta t$, se vinculen con las posiciones vecinas en la grilla espacial.
\par 
S\'olo resta integral el t\'ermino derecho de la \eq{eq:elb_integral}. Empleando em m\'etodo de Euler expl\'icito, puede obtenerse finalmente la ecuaci\'on de lattice Boltzmann
\begin{equation}
	f_i(\bm{x}+\bm{e_i}\Delta t,t+\Delta t)-f_i(\bm{x},t)=\Delta t\Omega_i(\bm{x},t).
	\label{eq:elb}
\end{equation}

La discretizaci\'on de Euler empleada conduce a una aproximaci\'on de primer orden en la discretizaci\'on de espacio y tiempo. Sin embargo, puede demostrarse que si se realiza dicha integraci\'on mediante el m\'etodo trapezoidal \cite{he_discrete_1998}, y con una redefinici\'on adecuada de la funci\'on de distribuci\'on discreta, es posible obtener una ecuaci\'on igual a \ref{eq:elb}. Por lo tanto, es posible afirmar que la \eq{eq:elb} constituye una aproximaci\'on de segundo orden tambi\'en en espacio y tiempo.

\section{Operadores de colisi\'on}
LBGK y MRT. Matrices de transformaci\'on?

\section{La expansi\'on de Chapman-Enskog}
Podemos ponerla ac\'a, aunque hay que ver como queda con las cuentas m\'as adelante.
Hay que ver, pero podr\'ian ir ac\'a las cuentas de la ecuaci\'on b\'asica.

\section{Overview de LBM}
Algoritmo, colision, streaming, etc.