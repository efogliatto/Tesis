\chapter{Simulaci\'on de flujo multif\'asico isot\'ermico}
\label{chap:isot}

Gracias a su naturaleza cin\'etica, LB se ha convertido en una metodolog\'ia no tradicional para la simulaci\'on de la mec\'anica de fluidos. La eficiencia computacional inherente y la simplicidad de implementaci\'on han motivado, y a\'un lo hacen, a la exploraci\'on y desarrollo de modelos num\'ericos destinados a abordar la representaci\'on de fen\'omenos complejos, como aquellos presentes en problemas de ebullici\'on y condensaci\'on.

Las funciones de distribuci\'on de equilibrio pueden construirse adecuadamente para representar momentos hidrodin\'amicos de inter\'es, como densidad, velocidad, y energ\'ia. Sin embargo, el transporte de una \'unica \fdp{} que permita reproducir con precisi\'on la totalidad de las ecuaciones macrosc\'opicas objetivo, suele involucrar restricciones significativas de estabilidad y un elevado costo computacional \cite{guo_lattice_2013}. Por lo tanto, la estrategia m\'as utilizada consiste en separar la simulaci\'on en dos etapas; por un lado, se aborda una \lbe{} para la resoluci\'on de la conservaci\'on de masa e impulso (usualmente llamada \lbe{} hidrodin\'amica), y por otro lado se aplica una estrategia espec\'ifica para el transporte de energ\'ia.

En este cap\'itulo se aborda la primera de estas etapas, describiendo las principales alternativas para la simulaci\'on de flujos multif\'asicos isot\'ermicos con LB, y continuando con la elecci\'on y descripci\'on detallada de un modelo bidimensional que sirve como base para el desarrollo de esta tesis. Por otro lado, se incluye el desarrollo y aplicaci\'on  de un problema de prueba, con soluci\'on anal\'itica, que permite evaluar la capacidad del modelo para representar el equilibrio termodin\'amico de un sistema l\'iquido-vapor bajo diferentes condiciones hidrodin\'amicas. Esta soluci\'on de referencia permiti\'o cuantificar, por un lado, el efecto de la fuerza gravitacional en la existencia y posici\'on de una interfase en equilibrio. Por otro lado, se verific\'o la reproducci\'on adecuada de densidades de coexistencia y la resoluci\'on espacial del m\'etodo. Los resultados de este an\'alisis se encuentran publicados en \cite{fogliatto_simulation_2019}, y son incorporados de manera incremental en los cap\'itulos siguientes.
%\newpage

\section{Lattice Boltzmann para flujo multif\'asico}
El crecimiento de la mec\'anica de fluidos computacional fue acompa\~nado por el desarrollo de numerosos m\'etodos num\'ericos macrosc\'opicos destinados a resolver las ecuaciones de Navier-Stokes en flujos multif\'asicos \cite{scardovelli_direct_1999}, como los m\'etodos \emph{front-tracking}, \emph{Volume of Fluid} (VOF) y \emph{Level Set} (LS). A pesar de la amplia difusi\'on adquirida, y de la demostrada capacidad para resolver con precisi\'on diversos escenarios con flujos multif\'asicos, estas t\'ecnicas tradicionales contin\'uan presentando limitaciones que dificultan el modelado de fen\'omenos presentes en problemas de ebullici\'on. En particular, detro de estas restricciones se destaca la capacidad de \emph{front-tracking} para simular adecuadamente procesos de coalescencia y ruptura de una interfase \cite{scardovelli_direct_1999,liu_three-dimensional_2012}, o los pasos de reconstrucci\'on o reinicializaci\'on de la interfase usualmente requeridos por VOF y LS, que pueden no tener una b\'ase f\'isica s\'olida adem\'as de resultar complejos de implementar \cite{liu_three-dimensional_2012}. Por otro lado, suelen originarse inestabilidades num\'ericas en el uso de VOF o LS para simular flujos dominados por tensi\'on superficial en geometr\'ias complejas \cite{scardovelli_direct_1999}.
\nomenclature[A]{VOF}{Volume of Fluids}
\nomenclature[A]{LS}{Level set}
\par
En comparaci\'on con otros m\'etodos computacionales, LB presenta ventajas para la simulaci\'on de flujos complejos. Por un lado, la naturaleza mesosc\'opica con base en la teor\'ia cin\'etica molecular permite generar modelos con s\'olidos fundamentos termodin\'amicos. Por otro lado, es posible incorporar directamente el uso de ecuaciones de estado en la resoluci\'on de Navier-Stokes en escala macrosc\'opica, lo que a su vez elimina la necesidad de resolver una ecuaci\'on de Poisson para la presi\'on. Finalmente, la mayor\'ia de los modelos son sencillos de programar, y la naturaleza local de las operaciones involucradas facilita la explotaci\'on de arquitecturas con paralelismo masivo.

Las mencionadas caracter\'isticas han motivado el desarrollo de esquemas para flujo multif\'asico pr\'aticamente desde el origen del m\'etodo, y que en general pueden agruparse en cuatro categor\'ias o familias principales: gradiente de color (\emph{color-gradient}) \cite{liu_three-dimensional_2012,gunstensen_lattice_1991}, pseudopotencial (\emph{pseudopotential}) \cite{shan_lattice_1993,shan_simulation_1994,chen_critical_2014}, energ\'ia libre (\emph{free-energy}) \cite{swift_lattice_1996,inamuro_galilean_2000} y \emph{phase-field} \cite{he_lattice_1999,liang_phase-field-based_2014}. Cada grupo se basa en fundamentos termodin\'amicos diferentes, lo que origina implementaciones num\'ericas con beneficios y desventajas y, por lo tanto, rangos de aplicabilidad distintos dentro de la simulaci\'on de flujos multif\'asicos. A continuaci\'on se brindar\'a una breve descripci\'on de estos grupos, destinada simplemente a destacar sus diferencias para justificar la posterior elecci\'on de una familia.
\newpage

\subsection*{M\'etodo de gradiente de color}
El m\'etodo de gradiente de color fue introducido por Gunstensen et al. \cite{gunstensen_lattice_1991}, como una versi\'on mejorada del modelo LGA multif\'asico de Rothman y Keller \cite{rothman_immiscible_1988}. En este modelo las fases se denotan con diferentes colores, y la interacci\'on entre part\'iculas, responsable de la separaci\'on de fases, es modelada con gradientes locales de color asociado a la diferencia de densidad entre ambas fases. Tomando como ejemplo un sistema de dos fases, el modelo original usa dos tipos de funciones de distribuci\'on, $f_{r{\alpha}}$ y $f_{b{\alpha}}$, para representar a los fluidos rojo y azul respectivamente. La distribuci\'on total de la mezcla $f_{\alpha} = f_{r{\alpha}}+f_{b{\alpha}}$ evoluciona como:
\begin{equation}
	f_{\alpha}(\bm{x}+\bm{e}_{\alpha} \delta_t,t+\delta_t) - f_{\alpha}(\bm{x},t) = \Omega_{\alpha}^c + \Omega_{\alpha}^p,
\end{equation}
donde $\Omega_{\alpha}^c$ denota los efectos de colisi\'on y $\Omega_{\alpha}^p$ se encuentra relacionado con la tensi\'on interfacial. En este caso, las densidades y velocidades para cada fase se definen como
\begin{equation}
	\begin{gathered}
	\rho_k = \sum_{\alpha} f_{k{\alpha}}, \qquad \rho_k\bm{u}_k = \sum_{\alpha} \bm{e}_{\alpha} f_{k{\alpha}}, \qquad k=r,b, \\
	\rho = \rho_r + \rho_b, \qquad \rho\bm{u} = \rho_r\bm{u}_r + \rho_b\bm{u}_b.
	\end{gathered}
\end{equation}

Si bien es posible emplear un operador LBGK para $\Omega_i^c$, el t\'ermino $\Omega_i^p$ se calcula empleando un par\'ametro de orden que tiene en cuenta la diferencia de densidad entre fases. Despu\'es de la colisi\'on, las funciones de distribuci\'on parciales son sometidas a un paso de ajuste de color antes de la advecci\'on. Estos pasos adicionales del algoritmo contribuyen a producir inestabilidades num\'ericas, a la vez que reducen de forma dr\'astica la eficiencia computacional por paso de tiempo \cite{guo_lattice_2013}.

\subsection*{M\'etodo de energ\'ia libre}
El m\'etodo \emph{free-energy} fue propuesto originalmente por Swift y colaboradores. \cite{swift_lattice_1996}, y presenta un punto de partida asociado a consideraciones termodin\'amicas b\'asicas. La idea detr\'as de estos m\'etodos consiste en derivar una funci\'on de distribuci\'on de equilibrio adecuada, de forma que el momento de segundo orden correspondiente incluya un tensor de presi\'on termodin\'amico no ideal. En particular, este tensor se deriva a partir de la energ\'ia libre de un fluido asociado a una EOS de van der Waals (vdW) y puede escribirse como:
\nomenclature[A]{vdW}{van der Waals}
\begin{equation}
	P^{'}_{\alpha\beta}=p\delta_{\alpha\beta}+\kappa\dfrac{\partial \rho}{\partial x_{\alpha}}\dfrac{\partial \rho}{\partial x_{\beta}},
\end{equation}
donde $\kappa$ es una constante asociada al valor de tensi\'on superficial en la interfase. Para lograr la recuperaci\'on de este tensor, Swift y sus colaboradores sugirieron el uso de una \lbe{} con operador de colisi\'on LBGK, mientras que la distribuci\'on de equilibrio satisface las siguientes restricciones:
\begin{equation}
	\sum_{\alpha} f_{\alpha}^{eq} = \rho, \qquad \sum_{\alpha} \bm{e}_{\alpha} f_{\alpha}=\rho\bm{u}, \qquad
	\sum_{\alpha} \bm{e}_{\alpha} \bm{e}_{\alpha} f_{\alpha}= \bm{P}^{'}+\rho\bm{u}\bm{u}.
	\label{eq:free_energy+rest}
\end{equation}

De esta manera, $f^{eq}$ debe escribirse como un polinomio de $\bm{u}$ con coeficientes elegidos adecuadamente para recuperar el tensor de presi\'on como un momento de la FDP.

%\begin{equation}
%	f_i(\bm{x}+\bm{e}_i\delta_t,t+\delta_t) - f_i(\bm{x},t) = -\dfrac{1}{\tau}\left[ f_i - f_i^{eq}(\rho, \bm{u}, \nabla\bm{u}) \right],
%\end{equation}
%mientras que la distribuci\'on de equilibrio satisface las siguientes restricciones:
%\begin{equation}
%	\sum_i f_i^{eq} = \rho, \qquad \sum_i \bm{e}_if_{i}=\rho\bm{u}, \qquad
%	\sum_i \bm{e}_i\bm{e}_if_{i}= \bm{P}^{'}+\rho\bm{u}\bm{u}
%	\label{eq:free_energy+rest}
%\end{equation}

%De forma similar a lo que ocurre con el modelo est\'andar para flujos de una \'unica fase, $f^{eq}$ puede escribirse como un polinomio de $\bm{u}$:
%\begin{subequations}
%	\begin{equation}
%		f_i^{eq}=A + B(\bm{e}_i \cdot \bm{u}) + C u^2 + D(\bm{e}_i \cdot \bm{u})^2 + G:\bm{e}_i\bm{e}_i, \qquad i\neq 0,
%	\end{equation}
%	\begin{equation}
%		f_i^{eq}=A_0 + C_0 u^2, \qquad i = 0.
%	\end{equation}
%\end{subequations}
%
%Los coeficientes de $f_i^eq$ para una grilla bidimensional pueden obtenerse empleando las restricciones de la \eq{eq:free_energy+rest}:
%\begin{equation}
%	\begin{gathered}
%		A_0 = \rho - 6 A, \qquad C_0 = -\rho, \\
%		A = \dfrac{1}{3}(p_0-\kappa \rho \nabla^2 \rho), \qquad B = \dfrac{\rho}{3}, \qquad C = -\dfrac{\rho}{6}, \qquad  D = \dfrac{2\rho}{3},  \\
%		G_{xx} = -G_{yy} = \dfrac{\kappa}{3}\left[ \left(\dfrac{\partial \rho}{\partial x}\right)^2 - \left(\dfrac{\partial \rho}{\partial y}\right)^2 \right], \qquad G_{xy}=\dfrac{2\kappa}{3}\dfrac{\partial \rho}{\partial x} \dfrac{\partial \rho}{\partial y}.
%	\end{gathered}
%\end{equation}
%
%De esta forma, las ecuaciones macrosc\'opicas recuperadas usando el m\'etodo de Swift resultan:
%\begin{equation}
%	\dfrac{\partial \rho}{\partial t} + \nabla \cdot (\rho \bm{u}) = 0,
%\end{equation}
%\begin{align}
%	\dfrac{\partial \rho \bm{u}}{\partial t} + \nabla \cdot (\rho \bm{uu}) =& -\nabla p_0 + \nu \nabla^2 (\rho \bm{u})+\nabla[\lambda \nabla \cdot (\rho \bm{u})]		\\
%	&-\left( \tau - \dfrac{1}{2} \right)\dfrac{\partial p_0}{\partial \rho} \delta_t \nabla \cdot [\bm{u}\nabla \rho + (\nabla \rho)\bm{u}],
%\end{align}
%donde 
%\begin{equation}
%	\nu = \dfrac{\delta_t}{4}\left( \tau - \dfrac{1}{2} \right), \qquad \lambda = \delta_t\left( \tau - \dfrac{1}{2} \right)\left( \dfrac{1}{2} - \dfrac{\partial p_0}{\partial \rho}\right)
%\end{equation}
%
%\textcolor{red}{Falta decir q\'ue es $p_0$.}

Las primeras versiones asociadas a esta familia sufrieron la falta de invariancia galileana debido a la recuperaci\'on de t\'erminos que no est\'an relacionados con Navier-Stokes, originados por la misma incorporaci\'on del tensor de presi\'on en la distribuci\'on de equilibrio \cite{kuzmin_multi-relaxation_2008}. Para recuperar esta invariancia es necesario, por lo tanto, incorporar t\'erminos de correcci\'on en la funci\'on de distribuci\'on de equilibrio. Este tipo de adaptaciones son similares a aquellas adoptadas por las versiones posteriores de los m\'etodos dentro de la familia \emph{color-gradient}, y usualmente constituyen fuentes adicionales de inestabilidad num\'erica al incorporar t\'erminos como $\bm{u}\nabla\rho$ y $\bm{u}\cdot\nabla\rho$.


\subsection*{M\'etodo \emph{phase-field}}
Esta categor\'ia representa a los modelos basados en la teor\'ia de \emph{phase-field}, es decir, aquellos en los que la din\'amica de la interfase se encuentra descripta por un par\'ametro de orden regido por una ecuaci\'on de Cahn-Hilliard o similar \cite{jacqmin_calculation_1999}. Esta aproximaci\'on a la simulaci\'on de flujos multif\'asicos con LB tiene su contraparte equivalente dentro de las t\'ecnicas tradicionales de CFD para modelos de interfase difusa, como el de Ding y colaboradores \cite{ding_diffuse_2007}.

La versi\'on original de He y colaboradores \cite{he_lattice_1999} hace uso de dos funciones de distribuci\'on, $g$ y $f$, para recuperar las ecuaciones de Navier-Stokes y una del tipo Cahn-Hilliard para la evoluci\'on de la interfase, respectivamente. En este caso, cada \lbe{} contiene un operador LBGK con un t\'ermino de fuente $S_{\alpha}$ y distribuciones de equilibrio dadas por:

%Usando operadores de colisi\'on LBGK, las ecuaciones corresponden a:
%\begin{equation}
%	g_i(\bm{x}+\bm{e}_i\delta_t,t+\delta_t) - g_i(\bm{x},t) = -\dfrac{1}{\tau_1}\left[ g_i(\bm{x},t) - g_i^{eq}(\bm{x},t) \right] + S_i(\bm{x},t)\delta_t,
%	\label{eq:he_g_eq}
%\end{equation}
%\begin{equation}
%	f_i(\bm{x}+\bm{e}_i\delta_t,t+\delta_t) - f_i(\bm{x},t) = -\dfrac{1}{\tau_2}\left[ f_i(\bm{x},t) - f_i^{eq}(\bm{x},t) \right] + S_i^{'}(\bm{x},t)\delta_t,
%\end{equation}
%donde la viscosidad cinem\'atica se recupera mediante $\nu=(c_s^2)(\tau_1-0.5)\delta_t$, $\tau_2$ se relaciona con la mobilidad de la ecuaci\'on de Cahn-Hilliard, y $S_i$, $S_i^{'}$ son t\'erminos de fuente. Las funciones de distribuci\'on de equilibrio se definen mediante:
\begin{equation}
	g_{\alpha}^{eq} = w_{\alpha}\left[ p + \rho c_s^2 \left( \dfrac{e_{{\alpha}\beta}u_{\beta}}{c_s^2}  + \dfrac{e_{\alpha\beta}u_{\beta}e_{{\alpha}\gamma}u_{\gamma}}{2c_s^4} - \dfrac{u_{\beta}u_{\beta}}{2c_s^2} \right)  \right],
\end{equation}
\begin{equation}
	f_{\alpha}^{eq} = w_{\alpha} \phi \left[ 1 + \dfrac{e_{{\alpha}\beta}u_{\beta}}{c_s^2}  + \dfrac{e_{\alpha\beta}u_{\beta}e_{{\alpha}\gamma}u_{\gamma}}{2c_s^4} - \dfrac{u_{\beta}u_{\beta}}{2c_s^2}  \right]
%	f_i^{eq} = w_i \phi \left[ 1 +  \dfrac{e_{i\alpha}u_{\alpha}}{c_s^2}  + \dfrac{e_{i\alpha}u_{\alpha}e_{i\beta}u_{\beta}}{2c_s^4} - \dfrac{u_{\alpha}u_{\alpha}}{2c_s^2}  \right],
\end{equation}
donde $\phi$ es el par\'ametro de orden que se utiliza, por ejemplo, para determinar la distribuci\'on de densidad considerando la presencia de una fase l\'iquida ($l$) y otra gaseosa ($g$):
\begin{equation}
	\rho(\phi) = \rho_g + \dfrac{\phi - \phi_g}{\phi_l - \phi_g}(\rho_l - \rho_g).
\end{equation}

Las variables macrosc\'opicas del modelo de He se calculan como:
\begin{equation}
	\begin{gathered}
		\phi = \sum_{\alpha} f_{\alpha} \\
		p = \sum_i g_i - \dfrac{\delta_t}{2} u_{\beta} \dfrac{\partial(p - \rho c_s^2)}{\partial x_{\beta}} \\
		\rho \bm{u}c_s^2 = \sum_{\alpha} \bm{e}_{\alpha}g_{\alpha} + \dfrac{\delta_t}{2}c_s^2 \bm{F}
	\end{gathered}
	\label{eq:he_macro_variables}
\end{equation}
donde $\bm{F}$ representa las fuerzas externas, incluyendo las asociadas a la tensi\'on interfacial. La expansi\'on de Chapman-Enskog muestra que este tipo de modelos permite recuperar una ecuaci\'on de conservaci\'on de impulso donde la presi\'on $p$ no est\'a asociada a una ecuaci\'on de estado, es decir:
\begin{equation}
	\dfrac{\partial (\rho \bm{u})}{\partial t} + \nabla \cdot (\rho \bm{uu})  = -\nabla p  + \nu \nabla \cdot \left[ \rho (\nabla\bm{u} + \nabla \bm{u}^T) \right] + \bm{F}.
\end{equation}
Por otro lado, el par\'ametro de orden satisface una ecuaci\'on del tipo Cahn-Hilliard:
\begin{equation}
	\dfrac{\partial \phi}{\partial t} + \nabla \cdot (\phi \bm{}u) = \dfrac{1}{2} M_{\phi} \nabla^2 (p - c_s^2 \phi),
\end{equation}
donde $M_{\phi}$ corresponde a un coeficiente de mobilidad asociado al factor de relajaci\'on del operador de colisi\'on. 

Este familia de modelos permite alcanzar una elevada precisi\'on en la representaci\'on de interfases. Sin embargo, su implementaci\'on suele ser compleja y m\'as costosa computacionalmente que el resto de las familias \cite{huang_multiphase_2015}.



\subsection*{M\'etodo pseudopotencial}
El m\'etodo \pp{}, que podr\'ia considerarse como la t\'ecnica m\'as sencilla para simular flujos multif\'asicos, fue propuesta por Shan y Chen \cite{shan_lattice_1993,shan_simulation_1994}. Las interacciones entre part\'iculas fluidas son imitadas mediante un potencial interpart\'icula, de modo que la separaci\'on de fases ocurre autom\'aticamente, sin necesidad de recurrir a t\'ecnicas para capturar o reconstruir interfases. Este (pseudo)potencial es el responsable de inducir un tensor de presi\'on no ideal, diferente al del m\'etodo \emph{free-energy}. La simplicidad conceptual y la elevada eficiencia computacional convirtieron a este m\'etodo en uno de los m\'as populares, habiendo sido utilizado con \'exito en la resoluci\'on de diversos problemas, como se ejemplifica en las secciones siguientes.
\par 
La ELB propuesta por Shan y Chen conserva la estructura est\'andar de los modelos de \'unica fase con operador LBGK:
\begin{equation}
	f_i(\bm{x}+\bm{e}_i\delta_t,t+\delta_t) - f_i(\bm{x},t)= -\dfrac{1}{\tau}\left[ f_i(\bm{x},t) - f_i^{eq}(\rho,\bm{u}^{eq}) \right],
\end{equation}
\nomenclature[N]{$\bm{u}^{eq}$}{Velocidad de equilibrio}
donde $\bm{u}^{eq}$ se conoce como velocidad de equilibrio. En este modelo, los principales momentos quedan definidos por:
\begin{equation}
	\sum_{\alpha} f_{\alpha} = \rho, \qquad	\sum_{\alpha} \bm{e}_{\alpha} f_{\alpha} = \rho \bm{u}^*,
\end{equation}
donde la velocidad $\bm{u}^*$ es utilizada para calcular $\bm{u}^{eq}$ y la velocidad real del fluido $\bm{u}$:
\begin{equation}
	\bm{u}^{eq} = \bm{u}^* + \dfrac{\bm{F}\tau}{\rho}, \qquad \bm{u} = \bm{u}^* + \dfrac{\bm{F}\delta_t}{2\rho}
\end{equation}

El modelo original de Shan y Chen introduce el uso de una fuerza de interacci\'on entre part\'iculas vecinas definida como:
\begin{equation}
	\bm{F}_{i}(\bm{x},t) = -G\psi(\bm{x},t)\sum_{\alpha} w_{\alpha} \psi(\bm{x}+\bm{e}_{\alpha},t)\bm{e}_{\alpha}
\end{equation}
\nomenclature[N]{$\bm{F}_i$}{Fuerza de interacci\'on}
donde $G$ es un par\'ametro que controla la intensidad de la fuerza de interacci\'on y $\psi$ es un potencial dado por:
\begin{equation}
	\psi(\rho) = \rho_0 \left[ 1-\mbox{e}^{-\frac{\rho}{\rho_0}} \right].
\end{equation}
En este potencial, $\rho_0$ es una constante arbitraria.

En general, el m\'etodo \pp{} permite recuperar una ecuaci\'on de conservaci\'on de impulso donde la presi\'on sigue una ecuaci\'on de estado de la forma:
\begin{equation}
	p(\rho) = \rho c_s^2 + \dfrac{c_s^2 \delta_t^2 G}{2} \psi^2 (\rho),
\end{equation}
y con una fuerza con t\'erminos que pueden vincularse a la presencia de tensi\'on superficial.
\bigskip


A pesar de la evoluci\'on y mejora de los diversos modelos, siguen existiendo diferencias significativas en las capacidades de simulaci\'on de problemas multif\'asicos din\'amicos, sobre todo cuando las relaciones de densidad entre fases ($\rho_l/\rho_g$) son elevadas. Como se menciona en el trabajo de Li y colaboradores. \cite{li_lattice_2016}, estas limitaciones pueden deberse a diferentes causas. Por un lado, existen diferencias en las cantidades f\'isicas que deben ser evaluadas a trav\'es de la interfase l\'iquido-vapor, como densidad en el modelo de energ\'ia libre o potencial en el modelo \pp{}. Por otro lado, c\'omo se mencion\'o previamente, las familias de gradiente de color y de energ\'ia libre necesitan correcciones adicionales para recuperar adecuadamente el comportamiento de Navier-Stokes, y como estos t\'erminos dependen expl\'icitamente del gradiente de densidad, suelen convertirse en fuentes de inestablidad num\'erica \cite{leclaire_unsteady_2014,leclaire_enhanced_2013,huang_simulations_2013}. Este hecho origina que los modelos de gradiente de color y energ\'ia libre encuentren severas limitaciones al momento de simular flujos con elevada relaci\'on de densidades y alto n\'umero de Reynolds, a pesar de los \'exitos observados en casos est\'aticos o cuasi-est\'aticos.

Por otro lado, los modelos multif\'asicos agrupados dentro de las familias \emph{phase-field} y \pp{} han sido aplicados exitosamente en la simulaci\'on de problemas con elevada relaci\'on de densidades y n\'umero de Reynolds moderados, como impacto y colisi\'on de droplets \cite{li_lattice_2013,lee_stable_2005} e incluso aplicaciones sencillas de transferencia de calor con cambio de fase \cite{safari_consistent_2014,markus_pool_2012,gong_lattice_2015}. En este \'ultimo aspecto es d\'onde la familia de modelos \pp{} presenta su mayor virtud: como se describe en las secciones siguientes, el potencial de interacci\'on puede modificarse para incorporar ecuaciones de estado arbitrarias, de modo que los procesos asociados a la transferencia de masa entre fases quedan determinados exclusivamente por  dicha ecuaci\'on. Adem\'as, a diferencia de los modelos \emph{phase-field}, si se elije una \lbe{} adecuada para recuperar macrosc\'opicamente una ecuaci\'on de energ\'ia, entonces no es necesario reconstruir la interfase para estimar la fuente de masa en la ecuaci\'on de impulso correspondiente \cite{safari_consistent_2014,safari_extended_2013}. De esta forma, los modelos LB para flujos multif\'asicos basados en la familia \pp{} permiten conservar la simplicidad y eficiencia computacional representativa de este m\'etodo, a\'un en la simulaci\'on de flujos complejos.


\section{El modelo \pp{}}
Originalmente, Shan y Chen introdujeron una interacci\'on no local entre part\'iculas fluidas, definiendo a la fuerza experimentada por las part\'iculas en la posici\'on $\bm{x}$ respecto aquellas en $\bm{x}'$ como:
\begin{equation}
	\bm{F}_i(\bm{x},\bm{x}') = -\tilde{G}(|\bm{x}-\bm{x}'|)\psi(\bm{x})\psi(\bm{x'})(\bm{x}-\bm{x}'),
	\label{eq:fint_green}
\end{equation}
donde $\tilde{G}$ es una funci\'on de Green y $\psi$ una masa efectiva que depende de la densidad local. La estructura de la fuerza dada por la \eq{eq:fint_green} fue dise\~nada adecuadamente por Shan y Chen, ya que si bien este acoplamiento entre masas efectivas no conserva el impulso local durante el proceso de colisi\'on, puede demostrarse que conserva el impulso total y, por lo tanto, no introduce impulso neto al sistema \cite{shan_simulation_1994}. De esta manera, la fuerza de interacci\'on total actuando sobre las part\'iculas en $\bm{x}$ se obtiene considerando todas las contribuciones $\bm{x}'$:
\begin{equation}
	\bm{F}_i(\bm{x}) = -\psi(\bm{x}) \sum_{\bm{x}'} \tilde{G}(|\bm{x}-\bm{x}'|)\psi(\bm{x}')(\bm{x}-\bm{x}').
\end{equation}

En un espacio discreto puede considerarse que cada nodo interact\'ua con $N$ vecinos, y si se asume que esta interacci\'on es isotr\'opica, es decir $\tilde{G} = \tilde{G}(|\bm{e}_{\alpha}|)$, entonces puede expresarse a la fuerza de interacci\'on discreta como:
\begin{equation}
	\bm{F}_i = -G\psi(\bm{x})c_s^2 \sum_{\alpha=1}^N \omega(|\bm{e}_{\alpha}|^2)\psi(\bm{x}+\bm{e}_{\alpha}\delta_t)\bm{e}_{\alpha},
	\label{eq:f_int}
\end{equation}
donde $G$  es la magnitud de la interacci\'on y $\{\omega(|\bm{e}_{\alpha}|^2)\}$ son coeficientes asociados a la discretizaci\'on isotr\'opica de $\bm{F}_i$. Estos pesos son diferentes de aquellos empleados en la EDF est\'andar (\eq{eq:feq}), y se encuentran definidos en la \tb{tab:coef_fza} para algunos conjuntos de velocidades de grilla.

\begin{table}[ht]
	\centering
    \begin{tabular}{c c c}
	    \toprule
        \bf Modelo & $\{\bm{e}_{\alpha}\}$ & $\{w_{\alpha}\}$  \\
        \midrule
        \multirow{3}{*}{D2Q9} & (0,0) & 0 \\
                              & ($\pm$1,0), (0,$\pm$1) & 1/3\\
                              & ($\pm$1,$\pm$1) & 1/12  \\                              
        \midrule
        \multirow{3}{*}{D3Q15} & (0,0,0) & 0 \\
                               & ($\pm$1,0,0), (0,$\pm$1,0), (0,0,$\pm$1) & 1/3   \\
                               & ($\pm$1,$\pm$1,$\pm$1) & 1/24  \\
        \bottomrule
	\end{tabular}
	\caption{Coeficientes de la fuerza de interacci\'on para diversos conjuntos de velocidades de grilla}
	\label{tab:coef_fza}
\end{table} 


La expansi\'on en serie de Taylor de la \eq{eq:f_int} muestra que los t\'erminos dominantes est\'an dados por \cite{shan_pressure_2008}:
\begin{equation}
	\bm{F}_i=-G\left[ c_s^2 \psi \nabla \psi + \dfrac{c_s^4}{2} \psi \nabla (\nabla^2 \psi)  + \ldots \right],
	\label{eq:f_int_taylor}
\end{equation}
por lo que, a pesar de su aparente simplicidad, esta fuerza de interacci\'on es capaz de incorporar elementos de fluidos no ideales, como una EOS relacionada con el primer t\'ermino del miembro derecho de la \eq{eq:f_int_taylor}, o el efecto de tensi\'on superficial relacionado con el segundo t\'ermino.



\subsection{Ecuaciones de estado y la regla de construcci\'on de Maxwell}
\label{sec:EOS}

Los modelos pseudopotenciales permiten recuperar, a nivel macrosc\'opico, una ecuaci\'on de conservaci\'on de impulso lineal en donde se identifica un tensor de presi\'on que depende de la masa reducida o potencial de interacci\'on. De esta manera, la elecci\'on de un potencial de interacci\'on determina directamente la dependencia de la presi\'on de equilibrio con propiedades macrosc\'opicas del fluido, como densidad y temperatura, constituyendo una ecuaci\'on de estado para el fluido simulado. 

La expresi\'on para este potencial no es \'unico, y es evidente que su elecci\'on est\'a ligada al comportamiento de cada fase. Por lo tanto, antes de evaluar el efecto de este potencial en el resultado de la aplicaci\'on de un modelo pseudopotencial, es necesario remarcar cu\'ales son los v\'inculos entre flujos multif\'asicos y ecuaciones de estado termodin\'amicas.

El an\'alisis de un sistema multif\'asico, como agua l\'iquida y vapor de agua, busca responder aspectos termodin\'amicos fundamentales sobre la condici\'on de equilibrio l\'iquido-vapor. En particular, es necesario establecer una relaci\'on entre las densidades de la fase l\'iquida ($\rho_l$) y de la fase gaseosa o de vapor ($\rho_g$), as\'i como la dependencia de la presi\'on con estas densidades. Este requerimiento f\'isico de mantener una coexistencia de fases impone una restricci\'on adicional en la ecuaci\'on de estado, es decir, en la ley que describe la compleja interdependencia entre la presi\'on $p$, los vol\'umenes molares $v$ (o densidades, ya que $v \propto 1/\rho$), y la temperatura $T$. 
\nomenclature[N]{$\rho_l$}{Densidad de fase l\'iquida}
\nomenclature[N]{$\rho_g$}{Densidad de fase de vapor}
\nomenclature[N]{$v$}{Volumen molar}
\nomenclature[N]{$v_l$}{Volumen molar de fase l\'iquida}
\nomenclature[N]{$v_g$}{Volumen molar de fase de vapor}

Las ecuaciones de estado m\'as conocidas tienen su origen en la teor\'ia cin\'etica de gases \cite{blundell_concepts_2006}. El modelo de gases reales m\'as utilzado es el de van der Waals (vdW), el cual resulta a su vez el m\'as simple pero que permite incorporar dos ingredientes cruciales: interacciones moleculares y mol\'eculas de tama\~no distinto de cero. La EOS de vdW es:
\begin{equation}
	\left( p + \dfrac{a}{v^2} \right) \left( v-b \right) = RT,
\end{equation}
donde $p$ es la presi\'on termodin\'amica, $T$ la temperatura, $R$ la constante universal de gases, y $v$ el volumen molar, es decir, el volumen ocupado por 1 mol de mol\'eculas del gas. En esta ecuaci\'on, la constante $a$ parametriza la intensidad de interacci\'on entre mol\'eculas, mientras que la constante $b$ incorpora el efecto del tama\~no finito de las mismas. Si $a$ y $b$ son nulos, la ecuaci\'on de vdW se reduce a la de gases ideales, es decir, $pv = RT$. Adem\'as, este comportamiento tambi\'en se recupera en el l\'imite de densidades muy bajas ($v \gg b$ y $v \gg \sqrt{a/\rho}$). Por otro lado, cuando la densidad es alta y $v$ se aproxima a $b$, el valor de presi\'on $p$ diverge.

\begin{figure}[ht]
	\centering
	\includegraphics[width=0.75\textwidth]{Pseudopotential/vdW_isoth}
	\caption{Diagrama $p-v$ para la ecuaci\'on de van der Waals. Se destacan las isotermas supercr\'iticas (rojo), cr\'itica (negro) y subcr\'iticas (azul).}
	\label{fig:vdW_isoth}
\end{figure}

La \fig{fig:vdW_isoth} ejemplifica el comportamiento de la ecuaci\'on de vdW, donde cada l\'inea corresponde a una isoterma. A medida que la temperatura desciende, las isotermas pasan de un comportamiento similar a un gas ideal, en la esquina superior derecha de la figura, a exhibir un comportamiento en forma de S con un m\'inimo y un m\'aximo locales, en la esquina inferior izquierda. De acuerdo a esas isotermas, existen tres valores de densidad asociadas a una misma presi\'on. Sin embargo, en esa zona de S existe una regi\'on donde $(\partial v / \partial \rho)_T$ es positiva, y por lo tanto se tiene compresibilidad negativa, lo que implica que esa regi\'on es inestable frente a perturbaciones de presi\'on \cite{blundell_concepts_2006}.
La temperatura a partir de la cual se produce este cambio de comportamiento se conoce como temperatura cr\'itica, y es la que se ilustra con una l\'inea m\'as gruesa en la \fig{fig:vdW_isoth}. Esta isoterma presenta un punto de inflexi\'on, conocido como punto cr\'itico, sobre el que se definen propiedades caracter\'isticas de la ecuaci\'on de estado. En particular, analizando las derivadas $(\partial p / \partial v)_T = 0$ y $(\partial^2 p / \partial v^2)_T = 0$, puede encontrarse cu\'al es ese punto cr\'itico, es decir, los valores de presi\'on cr\'itica, volumen molar cr\'itico y temperatura cr\'itica que lo caracterizan:
\begin{equation}
	\begin{gathered}
		p_c = \dfrac{a}{27 b^2} \\
		v_c = 3b \\
		T_c = \dfrac{8 a}{27 R b}
	\end{gathered}
	\label{eq:vdw_param_crit}
\end{equation}
\nomenclature[N]{$p_c$}{Presi\'on cr\'itica}
\nomenclature[N]{$v_c$}{Volumen molar cr\'itico}
\nomenclature[N]{$T_c$}{Temperatura cr\'itica}

En la \fig{fig:vdW_isoth} se evidencia que para temperaturas por debajo del valor cr\'itico, dos vol\'umenes molares diferentes pueden adoptar el mismo valor de presi\'on en equilibrio $p_0$ (en realidad son 3, pero uno es inestable). Por lo tanto, puede establecerse un estado de coexistencia entre dos fases, l\'iquido y vapor, que compartan igual energ\'ia libre de Gibbs (o equivalentemente potencial qu\'imico). Esta restriccici\'on implica:
\begin{equation}
	\int_{v_l}^{v_g} \left[p_0 - p(v',T)\right] \, \mbox{d} v' = 0,
	\label{eq:maxwell_constr}
\end{equation}
donde $p_0 = p(v_l,T) = p(v_g,T)$. La \eq{eq:maxwell_constr} se conoce como regla de construcci\'on de Maxwell, y determina los vol\'umenes de coexistencia de ambas fases para una determinada temperatura. Si se realiza un cambio de variables adecuado, la \eq{eq:maxwell_constr} puede reescribirse como:
\begin{equation}
	\int_{\rho_g}^{\rho_l} \left[p_0 - p(\rho',T)\right] \dfrac{1}{\rho'} \, \mbox{d} \rho' = 0,
	\label{eq:maxwell_constr_rho}
\end{equation}
donde $p_0 = p(\rho_l,T) = p(\rho_g,T)$. Gr\'aficamente, resolver la regla de Maxwell implica encontrar los vol\'umenes para los que las \'areas sombreadas de la \fig{fig:vdW_Maxwell} sean iguales. 

\begin{figure}[ht]
	\centering
	\includegraphics[width=0.75\textwidth]{Pseudopotential/vdW_Maxwell}
	\caption{Ejemplo de aplicaci\'on de la regla de construcci\'on de Maxwell. Dada una isoterma del diagrama $p-v$, los vol\'umenes de coexistencia son aquellos para los que las \'areas $A$ y $B$ son iguales.}
	\label{fig:vdW_Maxwell}
\end{figure}


La regla de construcci\'on de Maxwell aplica a cualquier EOS, e impone una restricci\'on termodin\'amica a las simulaciones realizadas con modelos \pp{}: si se desea recuperar el comportamiento de un fluido regido por una ecuaci\'on de estado, entonces la ``separaci\'on autom\'atica de fases'' propia de esta familia debe ser capaz de reproducir las densidades de equilibrio dadas por la \eq{eq:maxwell_constr}.


\subsubsection*{Otras ecuaciones de estado}

La ecuaci\'on de estado de vdW ha alcanzado una notable popularidad, no s\'olo por ser la primera en modelar el comportamiento de gases reales, sino porque a pesar de su simplicidad, permite representar fen\'omenos complejos asociados a la coexistencia y cambio de fase. Sin embargo, esta ecuaci\'on no es la \'unica, ya que se ha creado un amplio abanico de posibilidades en busca de una mejor representaci\'on de diversos tipos de fluidos. A continuaci\'on se detallan dos de las m\'as conocidas, apliamente utilizadas en la literatura de LB.

\smallskip
\textbf{Carnahan-Starling (C-S):}
\begin{equation}
	\begin{gathered}
		p = \rho R T\dfrac{1+b\rho/4+(b\rho/4)^2-(b\rho/4)^3}{(1-b\rho/4)^3} - a\rho^2, \\[2mm]
		p_c = \dfrac{0.07066 \, Ra}{b^2}, \qquad T_c = \dfrac{0.37733 \, a}{Rb}, \qquad \rho_c = \dfrac{0.5218}{b}.
	\end{gathered}
	\label{eq:CS_eos}
\end{equation}


\textbf{Peng-Robinson (P-R):}
\begin{equation}
	\begin{gathered}
		p = \dfrac{\rho R T}{1-b\rho} - \dfrac{a\varphi(\omega,T)\rho^2}{1+2b\rho-(b\rho)^2}, \\[0mm]
		\varphi(\omega,T) = \left[ 1+(0.37464+1.54226\omega-0.26992\omega^2)(1-\sqrt{T/T_c})\right], \\[0mm]
		p_c \approx \dfrac{0.01324 \, a}{b^2}, \qquad
		T_c \approx \dfrac{0.17015 \, a}{Rb}, \qquad
		\rho_c \approx \dfrac{0.253077}{b}.
	\end{gathered}
	\label{eq:PR_eos}
\end{equation}

\nomenclature[A]{C-S}{Carnahan-Starling}
\nomenclature[A]{P-R}{Peng-Robinson}


\subsubsection*{Curvas de coexistencia}

Como se mencion\'o previamente, la regla de construcci\'on de Maxwell permite determinar las densidades de coexistencia en equilibrio para cualquier EOS. La determinaci\'on de los l\'imites de esta integral no siempre es sencillo, dado que requiere la aplicaci\'on de un ciclo iterativo, con resultados que dependen de las constantes caracter\'isticas de cada EOS. Este c\'alculo, as\'i como la comparaci\'on objetiva entre diferentes ecuaciones de estado, puede simplificarse si se usa el concepto de unidades reducidas \cite{mcquarrie_molecular_1999}:
\begin{equation}
	\rho_r = \rho / \rho_c, \qquad T_r = T / T_c, \qquad p_r = p / p_c,
\end{equation}
donde los sub\'indices $r$ y $c$ denotan propiedades reducidas y cr\'iticas, respectivamente. De acuerdo a la ley de estados correspondientes, las propiedades reducidas deben ser las mismas independientemente del tipo de unidades utilizadas. Por lo tanto, las relaciones entre propiedades de coexistencia quedan un\'ivocamente determinadas para cada EOS, si se emplean unidades reducidas. De esta forma pueden construirse las llamadas curvas universales de coexistencia, como las mostradas en la \fig{fig:EOS}.

\begin{figure}[ht]
	\centering
	\includegraphics[width=0.75\textwidth]{Pseudopotential/EOS_comp}
	\caption{Densidades de coexistencia, en unidades reducidas, para diferentes ecuaciones de estado.}
	\label{fig:EOS}
\end{figure}


\nomenclature[N]{$p_r$}{Presi\'on reducida}
\nomenclature[N]{$\rho_r$}{Densidad reducida}
\nomenclature[N]{$T_r$}{Temperatura reducida}


\subsection{Incorporaci\'on de ecuaciones de estado en el potencial de interacci\'on}

La definici\'on de masa efectiva dada por Shan y Chen se aproxima a un valor asint\'otico cuando la densidad es alta, lo que contribuye a evitar el colapso de la fase de mayor densidad y, por lo tanto, contribuye a mejorar la estabilidad de las simulaciones. Sin embargo, el uso de esta expresi\'on fija la ecuaci\'on de estado final, lo que limita la aplicabilidad a diferentes fluidos. En 2006. Yuan y Schaefer \cite{yuan_equations_2006} demostraron que es posible alcanzar relaciones de densidad elevadas en casos est\'aticos si se emplea la masa efectiva introducida por He y Doolen \cite{he_thermodynamic_2002}:
\begin{equation}
	\psi(\rho) = \sqrt{\dfrac{2(p_{EOS} - \rho c_s^2)}{Gc^2}},
	\label{eq:potencial}
\end{equation}
donde $p_{EOS}$ representa una ecuaci\'on de estado no ideal, como vdW, C-S o P-R. De esta manera, esta ecuaci\'on para el potencial de interacci\'on flexibiliza el uso de modelos pseudopotenciales dado que permite, en principio, su empleo en la simulaci\'on de diversos tipos de fluidos regidos por ecuaciones de estado.




\subsection{La condici\'on de estabilidad mec\'anica y el problema de inconsistencia termodin\'amica}

En el caso sin fuerzas de interacci\'on, a nivel macrosc\'opico se recupera una ecuaci\'on de estado ideal de la forma $p=\rho c_s^2$. Sin embargo, la incorporaci\'on de la \eq{eq:f_int} produce una nueva ecuaci\'on de estado dependiente del potencial de interacci\'on:
\begin{equation}
	p = \rho c_s^2 + \dfrac{G}{2} c_s^2 \psi ^2,
\end{equation}
mientras que el tensor de presi\'on $\bm{P}$ queda definido s\'olo a trav\'es de la divergencia del mismo, es decir \cite{he_thermodynamic_2002}:
\begin{equation}
	\nabla \cdot \bm{P} = \nabla \cdot (\rho c_s^2 \bm{I}) - \bm{F}_i.
	\label{eq:ptens}
\end{equation}

Si se desea recuperar una expresi\'on expl\'icita para $\bm{P}$, Shan \cite{shan_pressure_2008} demostr\'o que para garantizar un balance mec\'anico exacto, debe considerarse una forma discreta de este tensor. En particular, esta expresi\'on puede derivarse a partir de una integral de volumen de la \eq{eq:ptens}:
\begin{equation}
	\int (\nabla \cdot \bm{P}) \, \mbox{d}\Omega = \int \nabla \cdot (\rho c_s^2 \bm{I})\, \mbox{d}\Omega - \int \bm{F}_i \, \mbox{d}\Omega,
	\label{eq:integral_pres}
\end{equation}
donde $\Omega$ es un volumen cerrado. Si se aplica el teorema de integraci\'on de Gauss a la \eq{eq:integral_pres} resulta:
\begin{equation}
	\int \bm{P} \, \mbox{d} \bm{A} = \int \rho c_s^2 \bm{I}\, \mbox{d} \bm{A} - \int \bm{F}_i \, \mbox{d}\Omega,
\end{equation}
donde $\mbox{d} \bm{A}$ es un diferencial de \'area. En forma discreta, esta integral puede escribirse como:
\begin{equation}
	\sum \bm{P} \cdot \bm{A} = \sum \rho c_s^2 \bm{I} \cdot \bm{A} - \sum \bm{F}_i,
\end{equation}
de modo que el tensor de presi\'on finalmente puede expresarse usando la dependencia de la fuerza de interacci\'on con el potencial sobre los nodos vecinos:
\begin{equation}
	\bm{P} = \rho c_s^2 \bm{I} + \dfrac{G}{2}\psi(\bm{x}) \sum_{\alpha=1}^N w(|\bm{e}_{\alpha}|^2)\psi(\bm{x}+\bm{e}_{\alpha})\bm{e}_{\alpha}\bm{e}_{\alpha}.
	\label{eq:ptens_shan}
\end{equation}

En el caso de considerar s\'olo interacciones con los vecinos cercanos (ubicados a una distancia m\'axima de $\sqrt{2}$ o $\sqrt{3}$ unidades de grilla en 2 o 3 dimensiones respectivamente), la expansi\'on en serie de Taylor de la \eq{eq:ptens_shan} permite extraer una aproximaci\'on anal\'itica y continua para el tensor de presi\'on recuperado:
\begin{equation}
	\bm{P} = \left( \rho c_s^2 + \dfrac{G c^2}{2} \psi^2 + \dfrac{G c^4}{12} \psi \nabla^2 \psi \right) \bm{I} + \dfrac{G c^4}{6} \psi \nabla \nabla \psi.
	\label{eq:ptens_shan_taylor}	
\end{equation}

La \eq{eq:ptens_shan_taylor} puede usarse para determinar la presi\'on normal a una interfase plana:
\begin{equation}
	P_n = \rho c_s^2 + \dfrac{G c^2}{2} \psi^2 + \dfrac{G c^4}{12} \left[ \alpha \left( \dfrac{d\psi}{dn} \right)^2 + \beta \psi \dfrac{d^2 \psi}{dn^2} \right],
	\label{eq:ptens_shan_plane}	
\end{equation}
donde $n$ denota la direcci\'on normal a la interfase, y en el caso de interacci\'on de vecinos cercanos se cumple $\alpha = 0$ y $\beta = 3$. Por lo tanto, tomando como base la \eq{eq:ptens_shan_plane} y considerando que en equilibrio la presi\'on $P_n$ debe ser igual a la presi\'on est\'atica en el seno del fluido \cite{shan_pressure_2008}, puede derivarse la condici\'on de estabilidad mec\'anica que cumplir\'a el fluido simulado:
\begin{equation}
	\int_{\rho_g}^{\rho_l} \left( p_0 - \rho c_s^2 - \dfrac{Gc^2}{2} \psi^2 \right) \dfrac{\psi'}{\psi^{1+\varepsilon}} \, \mbox{d}\rho = 0,
\end{equation}
donde $\psi' = d\psi / d\rho$, $\varepsilon=-2\alpha/\beta$ y $p_0=p(\rho_l)=p(\rho_g)$. De esta forma, puede verse que la condici\'on de estabilidad mec\'anica conduce a densidades de coexistencia que en general ser\'an diferentes a las establecidas por la construcci\'on de Maxwell (\eq{eq:maxwell_constr_rho}), ya que si el potencial de interacci\'on satisface la propuesta de He y Doolen, entonces en general no puede cumplirse que $\psi' / \psi^{1+\varepsilon} \propto 1/\rho^2$. Esta incompatibilidad se conoce con el nombre de inconsistencia termodin\'amica, y constituye uno de los principales t\'opicos de desarrollo en los modelos pseudopotenciales isot\'ermicos.



\subsection{\red{Adicionales?}}

\red{Podr\'ian ponerse ac\'a ciertos t\'opicos, como la recuperaci\'on de la tensi\'on superficial}





\section{El modelo isot\'ermico de Li et al.}

Los modelos pseudopotenciales proveen una alternativa sencilla y eficiente para poder simular num\'ericamente el comportamiento de flujos m\'ultif\'asicos. Esta simplicidad, sin embargo, tiene su precio: las primeras versiones encontraron r\'apidamente un l\'imite de aplicabilidad, no s\'olo por el problema de inconsistencia termodin\'amica, sino por la fuerte presencia de corrientes esp\'ureas en las interfases, a\'un en problemas est\'aticos o cuasi-est\'aticos. Esta combinaci\'on de factores llev\'o a que durante mucho tiempo, el uso del m\'etodo \pp{} se limitase a la resoluci\'on de problemas con baja relaci\'on de densidades y bajo n\'umero de Reynolds.

El camino hacia versiones m\'as estables fue forj\'andose con trabajos que buscaron identificar el origen de estas inestabilidades num\'ericas, e introdujeron con mecanismos te\'oricos para remediarlas (al menos parcialmente). A modo de ejemplo es interesante destacar el trabajo de Shan \cite{shan_analysis_2006}, que describe a las corrientes esp\'ureas como un fen\'omeno que tiene lugar cerca de la interfase de una burbuja estacionaria, y donde se produce un flujo peque\~no pero finito . El patr\'on de este flujo presenta la misma simetr\'ia que la grilla subyacente, y su magnitud es inversamente proporcional a la viscosidad del fluido simulado. Shan demostr\'o que existe una conexi\'on directa entre este fen\'omeno y la falta de isotrop\'ia en ciertos operadores diferenciales discretos, en particular el empleado en la reprentaci\'on discreta de la fuerza de interacci\'on (\eq{eq:f_int}). Denotando a los tensores 
\begin{equation}
	E^{(n)}_{i_1i_2\ldots i_n} = \sum_{\alpha}w(|\bm{e}_{\alpha}|^2)(\bm{e}_{\alpha})_{i_1} \cdots (\bm{e}_{\alpha})_{i_n},
\end{equation}
entonces puede escribirse el gradiente de una funci\'on $f$ como:
\begin{equation}
	\sum_{\alpha}w(|\bm{e}_{\alpha}|^2) f(\bm{x}+\bm{e}_{\alpha})\bm{e}_{\alpha}=(\nabla f)\cdot \bm{E}^{(2)} + \dfrac{1}{3!}(\nabla^{(3)} f)\cdot \bm{E}^{(4)} + \dfrac{1}{5!}\nabla^{(5)} f)\cdot \bm{E}^{(6)} + \ldots.
\end{equation}
Por lo tanto, la mejor aproximaci\'on a $\nabla f$ se logra si todos los tensores $\bm{E}^{(n)}$ son isotr\'opicos, aunque este requisito no puede alcanzarse debido a que existe un n\'umero finito de  velocidades discretas. Sin embargo, Shan demostr\'o que pueden encontrarse conjuntos adecuados de pesos $\{ w(\bm{e}_{\alpha})\}$ que mejoran notoriamente la isotrop\'ia de la aproximaci\'on, y por lo tanto, reducen la magnitud de las corrientes esp\'ureas.

Dentro de un contexto similar al presentado por Shan, Sbragaglia y sus colaboradores adoptaron una nueva expresi\'on para la fuerza de interacci\'on en la que se tienen en cuenta las interacciones de rango medio, es decir, se consideran aquellos nodos que no son vecinos inmediatos \cite{sbragaglia_generalized_2007}:
\begin{equation}
	\bm{F}_i = -c_s^2 \psi(\bm{x}) \sum_{\alpha} w(|\ea|^2) \left[G_1 \psi(\xplus)  + G_2 \psi(\bm{x}+2\bm{e}_{\alpha}) \right]
	\label{eq:fi_sbragaglia}
\end{equation}

Usando esta aproximaci\'on, Sbragaglia demostr\'o anal\'iticamente que, para una interfase plana, la \eq{eq:fi_sbragaglia} conduce a una tensi\'on superficial que depende de las constantes $G_1$ y $G_2$, y por lo tanto es ajustable. Por otro lado, la extensi\'on del stencil en el c\'alculo de la fuerza de interacci\'on permite reducir el espesor de la interfase y elevar la relaci\'on de densidades en simulaciones estacionarias.

%\red{poner cambios en esquemas de fuerzas}

Las contribuciones de Shan y Sbragaglia ilustran la evoluci\'on que ha sufrido (y que contin\'ua experimentando) el modelo original de Shan y Chen buscando mejorar la precisi\'on, estabilidad y aplicabilidad del m\'etodo. En pocas palabras, estos esfuerzos pueden describirse como un compromiso entre la aplicaci\'on adecuada de la fuerza de interacci\'on, y la preservaci\'on de un algoritmo eficiente y de sencilla implementaci\'on.

%\red{Mencionar que son modelos 2D}
Entre las alternativas pseudopotential m\'as recientes, el modelo introducido por Li y sus colaboradores \cite{li_lattice_2013} contiene esas caracter\'isticas de equilibrio antes mencionadas. En esta propuesta se hace uso de un operador de colisi\'on MRT, de modo que la \lbe{} resulta:
\begin{equation}
	\bm{f} (\bm{x} + \bm{e}\delta_t, t+\delta_t) = \bm{M}^{-1}\left[ \bm{m} - \bm{\Lambda}(\bm{m} - \feq{m})  + \delta_t \left( \bm{I} - \dfrac{\bm{\Lambda}}{2} \bar{\bm{S}} \right) \right].
	\label{eq:lbe_li}
\end{equation}

Como se mostr\'o en el \chap{chap:fundamentos}, $\bm{m} = \bm{Mf}$ corresponde a la proyecci\'on de la funci\'on de distribuci\'on $\bm{f}$ en el espacio de momentos, y $\feq{m} = \bm{M}\feq{f}$ a la transformaci\'on de la distribuci\'on de equilibrio. En este caso se usa la matriz de transformaci\'on y funci\'on de equilibrio est\'andar (\eqs{eq:MRT_M_D2Q9}{eq:feq} respectivamente), de modo que la distribuci\'on de equilibrio en el espacio de momentos puede escribirse como:
\begin{equation}
\feq{m} = \rho (1, -2+3|\bm{u}|^2, 1-3|\bm{u}|^2, u_x, -u_x, u_y, -u_y, u_x^2-u_y^2, u_xu_y)^T.
\label{eq:feq_li}
\end{equation}

La matriz $\bm{\Lambda}$ corresponde a una matriz diagonal cuyos componentes se denotan mediante
\begin{equation}
	\bm{\Lambda}=diag(\tau_{\rho}^{-1},\tau_{e}^{-1},\tau_{\zeta}^{-1},\tau_{j}^{-1},\tau_{q}^{-1},\tau_{j}^{-1},\tau_{q}^{-1},\tau_{\nu}^{-1},\tau_{\nu}^{-1}).
\end{equation}

En este modelo, las cantidades macrosc\'opicas conservadas corresponden a la densidad y velocidad, y pueden recuperarse siguiendo el esquema de fuerzas de Guo:
\begin{equation}
	\begin{gathered}
		\rho = \sum_{\alpha} f_{\alpha}, \\
		\rho \bm{u} = \sum_{\alpha} \bm{e}_{\alpha} f_{\alpha} + \dfrac{\delta_t}{2} \bm{F},
	\end{gathered}
\end{equation}

donde $\bm{F}$ corresponde a la fuerza total actuando sobre el sistema. En la mayor\'ia de los casos analizados, $\bm{F}$ contiene una componente volum\'etrica ($\bm{F}_b$) y otra asociada al potencial de interacci\'on, de modo que se utiliza $\bm{F} = \bm{F}_b + \bm{F}_i$.
\nomenclature[N]{$\bm{F}_b$}{Fuerza volum\'etrica}

Siguiendo la idea detallada en un trabajo anterior de Li y sus colaboradores \cite{li_forcing_2012}, la fuerza de interacci\'on tambi\'en debe incorporarse durante la colisi\'on a trav\'es del t\'ermino de fuente $\bar{\bm{S}}$, definido en el espacio de momentos como:
\begin{equation}
 \bar{\bm{S}} = 
 \left[ 
 	\begin{array}{c} 
 		0	\\
 		6 \bm{u} \cdot \bm{F} + \dfrac{12\sigma |\bm{F}_i|^2}{\psi^2 \delta_t (\tau_e-0.5)} \\
 		-6 \bm{u} \cdot \bm{F} - \dfrac{12\sigma |\bm{F}_i|^2}{\psi^2 \delta_t (\tau_{\zeta}-0.5)} \\
 		F_x \\
 		-F_x \\
 		F_y \\
 		-F_y \\
 		2(u_xF_x - u_yF_y) \\
 		(u_xF_y + u_yF_x)
 	\end{array} 
 \right]
 \label{eq:s_li}
\end{equation}

La principal novedad del modelo de Li consiste en la incorporaci\'on de t\'erminos adicionales en las componentes 1 y 2 de la \eq{eq:s_li}, que dependen linealmente de un par\'ametro libre $\sigma$. En particular, aplicando la expansi\'on de Chapman-Enskog a las Ecs.~(\ref{eq:lbe_li})-(\ref{eq:s_li}) se demuestra que las variables macrosc\'opicas satisfacen:
\begin{subequations}
	\begin{equation}
		\dfrac{\partial \rho}{\partial t} + \nabla \cdot (\rho \bm{u}) = 0,
	\end{equation}
\begin{equation}
	\dfrac{\partial (\rho \bm{u})}{\partial t} + \nabla \cdot (\rho \bm{uu}) = -\nabla \cdot (\rho c_s^2 \bm{I}) + \nabla \cdot \bm{\Pi} + \bm{F} - 2G^2 c^4 \sigma \nabla \cdot (|\nabla \psi|^2 \bm{I}),	
\end{equation}
\label{eq:li_macro}
\end{subequations}
donde el tensor $\bm{\Pi}$ corresponde a:
\begin{equation}
	\bm{\Pi} = \rho \nu \left[ \nabla \bm{u} + (\nabla \bm{u})^T \right] + \rho \left( \xi - \dfrac{2}{3}\nu \right) (\nabla \cdot \bm{u})\bm{I},
\end{equation}
y las viscosidades cinem\'atica y de volumen quedan definidas como:
\begin{subequations}
	\begin{equation}
		\nu = c_s^2 \left( \tau_{\nu} - \dfrac{1}{2}\right) \delta_t,
	\end{equation}
	\begin{equation}
		\xi = c_s^2 \left( \tau_{e} - \dfrac{1}{2}\right) \delta_t.
	\end{equation}	
\end{subequations}

\nomenclature[N]{$\sigma$}{Par\'ametro libre del esquema de fuerzas de Li}

De esta manera, el nuevo tensor de presi\'on satisface:
\begin{equation}
	\nabla \cdot \bm{P} = \nabla \cdot (\rho c_s^2 \bm{I}) - \bm{F} + 2G^2 c^4 \sigma \nabla \cdot (|\nabla \psi|^2 \bm{I})
\end{equation}
y, de acuerdo a la metodolog\'ia de Shan \cite{shan_pressure_2008}, puede escribirse como:
\begin{equation}
	\bm{P} = \bm{P}_{\mbox{orig}} + 2G^2 c^4 \sigma (|\nabla \psi|^2 \bm{I}),
\end{equation}
donde $\bm{P}_{\mbox{orig}}$ corresponde al tensor original definido por la \eq{eq:ptens_shan_taylor}. De este resultado se desprende que la nueva diferencia de presi\'on a trav\'es de una interfase plana corresponde a:
\begin{equation}
	P_n = \rho c_s^2 + \dfrac{G c^2}{2} \psi^2 + \dfrac{G c^4}{12} \left[ (\alpha+24G\sigma) \left( \dfrac{d\psi}{dn} \right)^2 + \beta \psi \dfrac{d^2 \psi}{dn^2} \right],
\end{equation}
y, por lo tanto, $\varepsilon=-2(\alpha + 24 G \sigma)/\beta$. De esta manera, la condici\'on de estabilidad mec\'anica ($\varepsilon$) ya no queda determinada s\'olo por el conjunto de velocidades de grilla, sino que puede ajustarse a trav\'es del par\'ametro libre $\sigma$. Esta nueva aproximaci\'on sigue sin cumplir formalmente con la incompatibilidad planteada por la inconsistencia termodin\'amica, pero como se muestra en las secciones siguientes, permite alcanzar una excelente representaci\'on de las curvas de coexistencia para un amplio rango de temperaturas.




\subsection{Condiciones de contorno}

La aplicaci\'on de condiciones de contorno a una \lbe{} consiste t\'ipicamente en una actualizaci\'on de ciertas componentes de la \fdp{} sobre los nodos de la frontera. Esta modificaci\'on debe realizarse despu\'es del paso de advecci\'on, y tiene como objetivo garantizar el comportamiento macroc\'opico deseado.

En el caso de flujos multif\'asicos, la interacci\'on fluido-s\'olido no debe considerarse mediante esquemas precisos que  adem\'as incorporen a la fuerza de interacci\'on. Una de las t\'ecnicas que re\'une estas caracter\'isticas fue propuesta originalmente por Zou y He \cite{zou_pressure_1997}, y est\'a basada en la idea de "rebotar" hacia el interior del dominio s\'olo las desviaciones respecto al estado de equilibrio. Debido a esta imposici\'on, el m\'etodo se conoce como \emph{non-equiilbrium bounce-back} (NEBB).
\nomenclature[A]{NEBB}{\emph{Non-equilibrium bounce-back}}

Para ilustrar la aplicaci\'on de este m\'etodo en una grilla D2Q9, puede tomarse como base una frontera con normal $(0,-1,0)$ como se muestra en la \fig{fig:d2q9_normal_plane}. La extensi\'on a otras orientaciones puede realizarse usando una rotaci\'on de las coordenadas espaciales.

\begin{figure}[ht]
	\centering
	\includegraphics[width=0.75\textwidth]{D2Q9_NEBB}
	\caption{Plano con normal saliente en $(0,-1,0)$, sobre un conjunto de velocidades D2Q9}
	\label{fig:d2q9_normal_plane}
\end{figure}

En este caso, despu\'es del paso de advecci\'on es necesario determinar las componentes $f_{\alpha}$ con $\alpha=2,5,6$.  Siguiendo la propuesta de Zou y He, s\'olo es necesario usar la idea de \emph{bounce-back} para las componentes de no equilibrio normales a la pared, es decir:
\begin{equation}
	f_{2} = f_{4} + f_{2}^{eq} - f_{4}^{eq} = f_4 + \dfrac{2}{3} \rho_w u_{w_y}.
	\label{eq:nebb_d2q9_f2}
\end{equation}

En esta ecuaci\'on, $\rho_w$ y $\bm{u}_w$ corresponden a los valores de densidad y velocidad sobre la pared. Para determinar $\rho_w$, $f_5$ y $f_6$ pueden usarse los momentos de $\bm{f}$ sobre la pared:
\begin{subequations}
	\begin{equation}
	\rho_w = \sum_{\alpha} f_{\alpha} = f_0+f_1+f_3+f_4+f_7+f_8+(f_2+f_5+f_6),
	\end{equation}
	\begin{equation}
	\rho_w u_{w_x}=\sum_{\alpha} e_{\alpha_x}f_{\alpha}  + \dfrac{\delta_t}{2}F_x = f_1-f_3+f_8-f_7 + (f_5-f_6) + \dfrac{\delta_t}{2}F_x,
	\end{equation}
	\begin{equation}
	\rho_w u_{w_y}=\sum_{\alpha} e_{\alpha_y}f_{\alpha} + \dfrac{\delta_t}{2}F_y = -(f_4+f_7+f_8) + (f_2+f_5+f_6) + \dfrac{\delta_t}{2}F_y.
	\end{equation}
	\label{eq:nebb_d2q9_mom}	
\end{subequations}

De esta manera, las \eqs{eq:nebb_d2q9_f2}{eq:nebb_d2q9_mom} pueden recombinarse para encontrar las componentes desconocidas:
\begin{subequations}
	\begin{equation}
		\rho_w = \dfrac{f_0+f_1+f_3+2(f_4+f_7+f_8)-\delta_tF_y/2}{1-u_{w_y}},
	\end{equation}
	\begin{equation}
		f_{2} = f_4 + \dfrac{2}{3} \rho_w u_{w_y},
	\end{equation}	
	\begin{equation}
		f_{5} = f_7 + \dfrac{1}{2} \rho_w u_{w_x} + \dfrac{1}{6} \rho_w u_{w_y} -\dfrac{1}{2}(f_1-f_3) - \dfrac{\delta_t}{4}(F_x+F_y),
	\end{equation}
	\begin{equation}
		f_{6} = f_8 - \dfrac{1}{2} \rho_w u_{w_x} + \dfrac{1}{6} \rho_w u_{w_y} +\dfrac{1}{2}(f_1-f_3) - \dfrac{\delta_t}{4}(-F_x+F_y).
	\end{equation}
	\label{eq:nebb_d2q9}	
\end{subequations}



\input{Isotermico_validacion.tex}


\section{Conclusiones}

%El m\'etodo de lattice Boltzmann se ha convertido en una t\'ecnica num\'erica robusta, que facilita la simulaci\'on de flujos complejos usando una aproximaci\'on no tradicional para resolver ecuaciones de transporte. Este mecanismo, por lo tanto, presenta caracter\'isticas favorables para la simulaci\'on microsc\'opica de ebullici\'on o condensaci\'on.

La simulaci\'on de flujos multif\'asicos con transferencia de calor involucra generalmente una resoluci\'on por etapas. Por un lado es necesario resolver una ecuaci\'on de lattice Boltzmann para representar el transporte de las variables macrosc\'opicas hidrodin\'amicas, como densidad y velocidad. La transferencia de energ\'ia, por otro lado, suele abordarse con una estrategia diferente.

En este cap\'itulo se analiz\'o la primera de estas etapas, tomando como base al conjunto de modelos de la familia pseudopotencial. En este m\'etodo se introduce una fuerza de interacci\'on entre part\'iculas de fluido vecinas, que depende de un potencial de interacci\'on asociado a ecuaciones de estado, como la de van der Waals. Esta fuerza origina la separaci\'on entre fases, sin necesidad de recurrir a t\'ecnicas adicionales para capturar o reconstruir la interfase.

Considerando las ventajas que presenta la familia pseudopotencial, se opt\'o por analizar y evaluar el modelo MRT bidimensional de Li y colaboradores mediante la simulaci\'on de problemas que presentan soluci\'on anal\'itica. En primer lugar, se verific\'o la capacidad del modelo de reproducir la curva de coexistencia de fases de la ecuaci\'on de estado de van der Waals. A partir de la simulaci\'on de dominios peri\'odicos sin fuerzas externas, se encontr\'o que el modelo es capaz de reproducir las densidades de coexistencia para un amplio rango de temperaturas, mediante el ajuste adecuado del par\'ametro libre $\sigma$. Estos resultados no se encuentran influenciados significativamente por el valor de los factores de relajaci\'on, aunque $\sigma$ debe ser adaptado a cada conjunto de constantes de la ecuaci\'on de estado.

Por otro lado, se introdujo una expresi\'on expl\'icita para evaluar la distribuci\'on de densidad en un fluido van der Waals dentro de una cavidad unidimensional, bajo acci\'on de la gravedad. Los resultados de las simulaciones mostraron que el modelo de Li reproduce adecuadamente los perfiles de densidad en un amplio rango de condiciones de simulaci\'on, como magnitud del campo gravitatorio o diferentes distribuciones de temperatura en el interior de la cavidad.

La soluci\'on del problema de estratificaci\'on de un fluido van der Waals es unidimensional, pero introduce un mecanismo rico y robusto para evaluar la precisi\'on de modelos pseudopotenciales. La comparaci\'on con una expresi\'on anal\'itica permite discriminar aspectos espec\'ificos de la simulaci\'on, como los efectos de las constantes de la ecuaci\'on de estado en la resoluci\'on de la interfase. En este aspecto, se verific\'o que para una misma temperatura y gravedad, el espesor de la interfase depende de estas constantes y no cambia con la cantidad de nodos de la grilla. Por lo tanto, se observ\'o que los cambios en la representaci\'on de la interfase debido a modificaciones en la cantidad de elementos de grilla, s\'olo puede cuantificarse de manera consistente mediante la representaci\'on de la soluci\'on num\'erica en unidades reducidas. Este resultado, observado en detalle en la simulaci\'on de un problema multif\'asico sin transferencia de calor, constituye un elemento fundamental para el an\'alisis de lattice Boltzmann como m\'etodo num\'erico, especialmente en la simulaci\'on de fen\'omenos de mayor complejidad.